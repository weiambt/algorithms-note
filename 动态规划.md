# åŠ¨æ€è§„åˆ’

è¶…å…¨DPé¢˜å•ï¼šhttps://leetcode.cn/circle/discuss/tXLS3i/

å…³é”®ç‚¹ï¼š

```
1.çŠ¶æ€è¡¨ç¤º 
   1.1 é›†åˆdp[i]è¡¨ç¤ºä»€ä¹ˆï¼š
   1.2 å±æ€§æ˜¯ä»€ä¹ˆï¼šä¸ªæ•°ã€æœ€å¤§å€¼
2.çŠ¶æ€è®¡ç®—ï¼šçŠ¶æ€æ–¹ç¨‹
3.åˆå§‹åŒ–

4.ç»†èŠ‚ç‚¹ï¼š
	éå†é¡ºåºçš„é‡è¦æ€§ï¼šå…ˆéå†èƒŒåŒ…è¿˜æ˜¯å…ˆéå†ç‰©å“
	æ‰“å°dpæ•°ç»„
```





- æ€è·¯

  - é€‰è¿˜æ˜¯ä¸é€‰

  - æšä¸¾é€‰å“ªä¸ª

    - ç›´æ¥æšä¸¾Oï¼ˆnï¼‰

    - äºŒåˆ†æšä¸¾é€‰å“ªä¸ªOï¼ˆlognï¼‰

    - å•è°ƒæ ˆæšä¸¾é€‰å“ªä¸ªOï¼ˆ1ï¼‰

    - æšä¸¾æœ€åä¸€æ¬¡åˆ†ç»„Oï¼ˆnï¼‰

      



å¸¸è§çŠ¶æ€è¡¨ç¤º

- `f[i][j]è¡¨ç¤ºå‰iä¸ªç‰©å“ï¼Œä½“ç§¯ä¸è¶…è¿‡jçš„é€‰æ³•çš„æœ€å¤§å€¼`
- `f[i][j]è¡¨ç¤ºå‰iä¸ªæ•°ä¸­é€‰ï¼Œå’Œä¸ºjçš„é€‰æ³•çš„æ–¹æ¡ˆæ•°`
- `f[i][j][k]è¡¨ç¤ºå‰iä¸ªç‰©å“ï¼Œé™åˆ¶1ï¼šä¸è¶…è¿‡jï¼Œé™åˆ¶2ï¼šä¸è¶…è¿‡kçš„é€‰æ³•`
- `f[i][j]è¡¨ç¤ºæ€»å’Œä¸ºiï¼Œç¬¬ä¸€ä¸ªæ•°æ˜¯jçš„é€‰æ³•åºåˆ—çš„æ–¹æ¡ˆæ•°`
- `f[i][k]ï¼Œk=0,1ã€‚è¡¨ç¤ºå‰iä¸ªæ•°ä¸­é€‰ï¼Œç¬¬iä¸ªæ•°çš„çŠ¶æ€æ˜¯kï¼ˆé€‰æˆ–ä¸é€‰ï¼‰çš„é€‰æ³•é›†åˆçš„æ–¹æ¡ˆæ•°`
- `f[i][j][k]ï¼Œk=0,1ã€‚è¡¨ç¤ºå‰iä¸ªæ•°ä¸­é€‰ï¼Œé™åˆ¶ï¼šä¸è¶…è¿‡jæ¬¡ï¼Œç¬¬iä¸ªæ•°çš„çŠ¶æ€æ˜¯kï¼ˆé€‰æˆ–ä¸é€‰ï¼‰çš„é€‰æ³•çš„æ–¹æ¡ˆæ•°`
- `f[u][k]ï¼Œk=0,1ã€‚è¡¨ç¤ºä»¥uä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ï¼Œæ ¹èŠ‚ç‚¹ué€‰æˆ–ä¸é€‰çš„é€‰æ³•é›†åˆçš„å±æ€§`
- `f[i]è¡¨ç¤ºä»¥arr[i]ç»“å°¾çš„å­åºåˆ—çš„å±æ€§`
- `f[i][j]è¡¨ç¤ºs1ä»å‰iä¸ªå­—ç¬¦ä¸­é€‰ï¼Œs2ä»å‰jä¸ªå­—ç¬¦ä¸­é€‰çš„æ–¹æ¡ˆæ•°`
- `f[i][j]è¡¨ç¤ºåŒºé—´[l,r]å†…çš„åˆå¹¶é—®é¢˜çš„å±æ€§`
- `f[i][j]è¡¨ç¤ºä»¥arr[i]ç»“å°¾çš„å­æ•°ç»„ä¸­ï¼Œå…±æ“ä½œjæ¬¡çš„æœ€å¤§å€¼`

### çŠ¶æ€å‹ç¼©

	dpçš„çŠ¶æ€å‹ç¼©
		1.æ­£å¸¸å†™ï¼š2ç»´
		2.ä¼˜åŒ–ç©ºé—´
			æ–¹å¼1ï¼šæ¯ä¸€è½®å®šä¹‰æ–°æ•°ç»„ fè¡¨ç¤ºä¸‹ä¸€è½®çš„dpå€¼ï¼Œæœ€ådp = f
			æ–¹å¼2ï¼šä½¿ç”¨å˜é‡tï¼Œåœ¨0å’Œ1ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œint dp[2][N], t^1
			æ–¹å¼3ï¼šé€†åºã€åˆ†æåä¿è¯æ¯ä¸ªéœ€è¦çš„çŠ¶æ€ä¹‹å‰æ²¡è¢«æ›´æ–°è¿‡
			å‚è€ƒhttps://leetcode.cn/problems/number-of-dice-rolls-with-target-sum/solutions/2497280/qian-zhui-he-you-hua-dp-by-weiambt-wsar/




## 1.èƒŒåŒ…æ¨¡å‹

> è‡³å°‘ã€æ°å¥½ã€è‡³å¤šçš„èƒŒåŒ…æ¨¡å‹æ€»ç»“ï¼šhttps://www.acwing.com/blog/content/458/

- æ‰€æœ‰èƒŒåŒ…æ¨¡å‹çš„ä¸€ç»´ä¼˜åŒ–ä¸­ï¼Œåªæœ‰ã€Šå®Œå…¨èƒŒåŒ…çš„ä¸€ç»´ä¼˜åŒ–ã€‹å’Œã€Šå¤šé‡èƒŒåŒ…çš„å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ã€‹è¿™ç§æƒ…å†µä½“ç§¯çš„å¾ªç¯æ˜¯ä»å°åˆ°å¤§ï¼Œå…¶ä»–æ‰€æœ‰çš„æƒ…å†µ ä½“ç§¯éƒ½æ˜¯ä»å¤§åˆ°å°æšä¸¾
- æ‰€æœ‰çš„äºŒç»´æƒ…å†µéƒ½æ˜¯ä½“ç§¯å’Œç‰©å“çš„å¾ªç¯é¡ºåºå¯ä»¥éšæ„ã€‚

![image-20221112133859513](img/image-20221112133859513.png)

![image-20221112133957488](img/image-20221112133957488.png)



## 2.æ•°å­—ä¸‰è§’å½¢æ¨¡å‹

éœ€è¦æ³¨æ„è¾¹ç•Œçš„é—®é¢˜ï¼ˆæ±‚æœ€å°å€¼æ—¶ä¹ˆè¦åˆå§‹åŒ–æˆINFï¼‰ã€‚ä¸‹æ ‡å°½é‡ä»1å¼€å§‹ã€‚è¿™æ ·æ‰èƒ½ä¿è¯ä½¿ç”¨æ»šåŠ¨æ•°ç»„



## 3.æœ€é•¿ä¸Šå‡å­åºåˆ—æ¨¡å‹

> dp[i]è¡¨ç¤ºä»¥arr[i]ç»“å°¾çš„ä¸€ç±»é—®é¢˜
>
> å¦‚æœæ˜¯å­æ•°ç»„çš„dpé—®é¢˜ï¼Œä¹Ÿè¦æƒ³åˆ°iç»“å°¾æ¨¡å‹

é¢˜ç›®ï¼š

> lc300ï¼šæœ€é•¿ä¸Šå‡å­åºåˆ— 
>
> lc53.ï¼šè¿ç»­å­æ•°ç»„æœ€å¤§å’Œ
>
> lc940ï¼šä¸åŒçš„å­åºåˆ— IIï¼ˆè®¡ç®—ä¸€ä¸ªä¸²çš„æ‰€æœ‰ä¸ç›¸ç­‰å­åºåˆ—çš„ä¸ªæ•°ï¼‰
>
> AcWing 1017. æ€ªç›—åŸºå¾·çš„æ»‘ç¿”ç¿¼

## 4.å‰iå‰jæ¨¡å‹

> dp [i] [j]è¡¨ç¤ºä»Açš„å‰iä¸ªå­—ç¬¦ä¸­é€‰æ‹©ï¼Œä»Bçš„å‰jä¸ªå­—ç¬¦ çš„æ–¹æ¡ˆæ•°



> æœ€é•¿å…¬å…±å­åºåˆ—
>
> lc115. ä¸åŒçš„å­åºåˆ—(å¯»æ‰¾Aä¸²ä¸­ä¸Bç›¸ç­‰çš„å­åºåˆ—çš„ä¸ªæ•°)
>
> acwing902ï¼šæœ€çŸ­ç¼–è¾‘è·ç¦»



## æ ‘å½¢dp

Oï¼ˆnï¼‰ï¼Œnæ˜¯èŠ‚ç‚¹æ€»æ•°

- æ ¹èŠ‚ç‚¹åœ¨dpæ•°ç»„ä¸­ï¼Œ`dp[u][1]`è¡¨ç¤ºä»¥uä¸ºæ ¹èŠ‚ç‚¹çš„ï¼Œå¹¶ä¸”é€‰æ‹©æ ¹èŠ‚ç‚¹çš„æƒ…å†µï¼Œ

  ä¾‹å­ï¼šæ²¡æœ‰ä¸Šå¸çš„èˆä¼š

- è®¡ç®—æ ‘çš„å‘ä¸‹æœ€å¤§é«˜åº¦

### æ²¡æœ‰ä¸Šå¸çš„èˆä¼š

> æ ‘ä¸Š01èƒŒåŒ…é—®é¢˜

https://www.acwing.com/activity/content/code/content/5382741/

```java
	static void dfs(int root) {
        //dp[root][0] = 0;
        dp[root][1] = happy[root];
        for(int i = h[root];i!=-1;i = ne[i]){
            int j = e[i];
            dfs(j);//é€’å½’å­æ ‘
            dp[root][0] += Math.max(dp[j][0],dp[j][1]);
            dp[root][1] += dp[j][0];
        }
    }
```

### å‘ä¸‹å…ƒç´ ä¸ªæ•°



### æ ‘çš„é‡å¿ƒ

ç»™å®šä¸€é¢—æ ‘ã€‚è¯·ä½ æ‰¾åˆ°æ ‘çš„é‡å¿ƒï¼Œå¹¶è¾“å‡ºå°†é‡å¿ƒåˆ é™¤åï¼Œå‰©ä½™å„ä¸ªè¿é€šå—ä¸­ç‚¹æ•°çš„æœ€å¤§å€¼ã€‚

é‡å¿ƒå®šä¹‰ï¼šé‡å¿ƒæ˜¯æŒ‡æ ‘ä¸­çš„ä¸€ä¸ªç»“ç‚¹ï¼Œå¦‚æœå°†è¿™ä¸ªç‚¹åˆ é™¤åï¼Œå‰©ä½™å„ä¸ªè¿é€šå—ä¸­å…ƒç´ çš„ä¸ªæ•°çš„æœ€å¤§å€¼æœ€å°ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹è¢«ç§°ä¸ºæ ‘çš„é‡å¿ƒã€‚

```java
//è¿”å›èŠ‚ç‚¹uçš„æ‰€æœ‰å­æ ‘çš„èŠ‚ç‚¹æ€»ä¸ªæ•°
static int dfs(int u,int fa) {
	int sum=0,mx=0;
	for(int i=h[u];i!=-1;i=ne[i]) {
		int j = e[i];
		if(j==fa) continue;
		int cnt = dfs(j,u);
		mx = Math.max(mx,cnt);
		sum += cnt;
	}
	mx = Math.max(mx,n-sum-1);
	if(mx < ans) {
		ans = mx;
		ansIdx = u;
	}
	return sum+1;
}
```


### å‘ä¸‹çš„æœ€é•¿è·¯å¾„

dfs(int u)å‡½æ•°è¿”å›uä½œä¸ºæ ¹èŠ‚ç‚¹æ—¶ï¼Œå‘ä¸‹çš„æœ€é•¿è·¯å¾„ã€‚

```java
	static int dfs(int u,int fa){
        int dist=0;
        for(int i=h[u];i!=-1;i=ne[i]){
            int j = e[i];
            if(j==fa) continue;
            int d = dfs(j,u) + w[i];
            dist = Math.max(dist,d);
        }
        return dist;
    }
```

### æ ‘çš„ç›´å¾„

> AcWing 1072. æ ‘çš„æœ€é•¿è·¯å¾„

è®¡ç®—å‘ä¸‹çš„æœ€é•¿ã€ç¬¬äºŒé•¿è·¯å¾„é•¿åº¦ã€‚

```java
	static int dfs(int u,int fa) {
		int d1 = 0,d2 = 0;
		for(int i=h[u];i!=-1;i=ne[i]) {
			int j = e[i];
			if(j==fa) continue;
			int len = dfs(j,u)+w[i];
			if(len>=d1) {
				d2 = d1;
				d1 = len;
			}else if(len>d2) {
				d2 = len;
			}
		}
		ans = Math.max(ans,d1+d2);
		return d1;
	}
```

### æ ‘çš„ä¸­å¿ƒ

ç»™å®šä¸€æ£µæ ‘ï¼Œæ¯æ¡è¾¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼ã€‚è¯·ä½ åœ¨æ ‘ä¸­æ‰¾åˆ°ä¸€ä¸ªç‚¹ï¼Œä½¿å¾—è¯¥ç‚¹åˆ°æ ‘ä¸­å…¶ä»–ç»“ç‚¹çš„æœ€è¿œè·ç¦»æœ€è¿‘ã€‚

https://www.acwing.com/activity/content/code/content/5390588/

```java
	//è®¡ç®—èŠ‚ç‚¹å‘ä¸‹çš„æœ€é•¿è·ç¦»ã€æ¬¡é•¿è·ç¦»	
	//ç”¨å­èŠ‚ç‚¹æ›´æ–°çˆ¶èŠ‚ç‚¹ï¼ˆå…ˆé€’ï¼Œåœ¨å½’çš„æ—¶å€™è®¡ç®—ï¼‰
	static int dfs_down(int u,int fa) {
		int dd1 = 0,dd2 = 0;
		int dd1_point = 0;
		for(int i=h[u];i!=-1;i=ne[i]) {
			int j = e[i];
			if(j==fa) continue;
			int len = dfs_down(j,u)+w[i];
			if(len>=dd1) {
				dd2 = dd1;
				dd1 = len;
				dd1_point = j;
			}else if(len>dd2) {
				dd2 = len;
			}
		}
		d1[u] = dd1;
		d2[u] = dd2;
		p1[u] = dd1_point;
		return dd1;
	}
	//è®¡ç®—å‘ä¸Šçš„æœ€é•¿è·ç¦»
	//ç”¨çˆ¶èŠ‚ç‚¹æ›´æ–°å­èŠ‚ç‚¹ï¼ˆå…ˆè®¡ç®—ï¼Œå†é€’å½’ï¼‰
	static void dfs_up(int u,int fa) {
		ans = Math.min(ans,Math.max(d1[u],up[u]));
		for(int i=h[u];i!=-1;i=ne[i]) {
			int j = e[i];
			if(j==fa) continue;
			up[j] = Math.max(up[u],p1[u]!=j?d1[u]:d2[u])+w[i];
			dfs_up(j,u);
		}
	}
```





- [1617. ç»Ÿè®¡å­æ ‘ä¸­åŸå¸‚ä¹‹é—´æœ€å¤§è·ç¦»](https://leetcode.cn/problems/count-subtrees-with-max-distance-between-cities/)

  >ç»™ä½  `n` ä¸ªåŸå¸‚ï¼Œç¼–å·ä¸ºä» `1` åˆ° `n` ã€‚åŒæ—¶ç»™ä½ ä¸€ä¸ªå¤§å°ä¸º `n-1` çš„æ•°ç»„ `edges` ï¼Œå…¶ä¸­ `edges[i] = [ui, vi]` è¡¨ç¤ºåŸå¸‚ `ui` å’Œ `vi` ä¹‹é—´æœ‰ä¸€æ¡åŒå‘è¾¹ã€‚é¢˜ç›®ä¿è¯ä»»æ„åŸå¸‚ä¹‹é—´åªæœ‰å”¯ä¸€çš„ä¸€æ¡è·¯å¾„ã€‚æ¢å¥è¯è¯´ï¼Œæ‰€æœ‰åŸå¸‚å½¢æˆäº†ä¸€æ£µ **æ ‘** ã€‚
  >
  >ä¸€æ£µ **å­æ ‘** æ˜¯åŸå¸‚çš„ä¸€ä¸ªå­é›†ï¼Œä¸”å­é›†ä¸­ä»»æ„åŸå¸‚ä¹‹é—´å¯ä»¥é€šè¿‡å­é›†ä¸­çš„å…¶ä»–åŸå¸‚å’Œè¾¹åˆ°è¾¾ã€‚ä¸¤ä¸ªå­æ ‘è¢«è®¤ä¸ºä¸ä¸€æ ·çš„æ¡ä»¶æ˜¯è‡³å°‘æœ‰ä¸€ä¸ªåŸå¸‚åœ¨å…¶ä¸­ä¸€æ£µå­æ ‘ä¸­å­˜åœ¨ï¼Œä½†åœ¨å¦ä¸€æ£µå­æ ‘ä¸­ä¸å­˜åœ¨ã€‚
  >
  >å¯¹äº `d` ä» `1` åˆ° `n-1` ï¼Œè¯·ä½ æ‰¾åˆ°åŸå¸‚é—´ **æœ€å¤§è·ç¦»** æ°å¥½ä¸º `d` çš„æ‰€æœ‰å­æ ‘æ•°ç›®ã€‚
  >
  >è¯·ä½ è¿”å›ä¸€ä¸ªå¤§å°ä¸º `n-1` çš„æ•°ç»„ï¼Œå…¶ä¸­ç¬¬ `d` ä¸ªå…ƒç´ ï¼ˆ**ä¸‹æ ‡ä» 1 å¼€å§‹**ï¼‰æ˜¯åŸå¸‚é—´ **æœ€å¤§è·ç¦»** æ°å¥½ç­‰äº `d` çš„å­æ ‘æ•°ç›®ã€‚
  >
  >**è¯·æ³¨æ„**ï¼Œä¸¤ä¸ªåŸå¸‚é—´è·ç¦»å®šä¹‰ä¸ºå®ƒä»¬ä¹‹é—´éœ€è¦ç»è¿‡çš„è¾¹çš„æ•°ç›®ã€‚
  >
  >n = 15

  ä¸¤é¢˜çš„ç»“åˆ,æšä¸¾å­é›† + æ ‘çš„ç›´å¾„

  ```
  class Solution {
       int N = 20,M = 2*N;
       int[] h = new int[N],e = new int[M],ne = new int[M];
       int idx;
       int n;
       void add(int a,int b){
          e[idx] = b;
          ne[idx] = h[a];
          h[a] = idx++;
      }
       int mxlen = 0;
       int[] vis2 = new int[N];
       int dfs(int u){
          int mx1 = 0,mx2 = 0;
          vis2[u] = 1;
          for(int i=h[u];i!=-1;i=ne[i]){
              int j = e[i];
              if(vis[j]==0 || vis2[j]==1) continue;
              // System.out.println(u+" "+j);
              int val = dfs(j);
              if (val >= mx1){
                  mx2 = mx1;
                  mx1 = val;
              }else if(val > mx2){
                  mx2 = val;
              }
          }
          mxlen = Math.max(mxlen,mx1+mx2+1);
          return mx1+1;
      }
       int[] vis = new int[N];
       void dfs_huisu(int u){
          if(u==n+1){
              // System.out.println("-------");
              // for(int i=1;i<=n;i++)
              //     System.out.print(vis[i]+" ");
              for(int i=1;i<=n;i++){
                  if(vis[i]==1){
                      Arrays.fill(vis2,0);
                      mxlen = 0;
                      dfs(i);
                      break;
                  }
              }
              
              int flag = 1;
              for(int i=1;i<=n;i++){
                  if(vis[i] != vis2[i]){
                       flag = 0;
                       break;
                  }    
              }
              
              if(mxlen>0 && flag==1){
                  // System.out.println(mxlen);
                  if(mxlen-2>=0)
                      ans[mxlen-2] += 1;
              } 
              return;
          }
          vis[u] = 1;
          dfs_huisu(u+1);
  
          vis[u] = 0;
          dfs_huisu(u+1);
       }
      int[] ans;
      public int[] countSubgraphsForEachDiameter(int nn, int[][] edges) {
          //1.æšä¸¾å­æ ‘
          //2.åˆ¤æ–­å­æ ‘åˆæ³•ï¼Ÿ
          //3.è®¡ç®—å­æ ‘ç›´å¾„
          //4.æ›´æ–°è´¡çŒ®
          n = nn;
          Arrays.fill(h,-1);
          ans = new int[n-1];
          Arrays.fill(vis,0);
          Arrays.fill(vis2,0);
          mxlen = 0;
          // idx = 0;
          for(int i=0;i<n-1;i++){
              int a = edges[i][0];
              int b = edges[i][1];
              add(a,b);
              add(b,a);
          }
          
          dfs_huisu(1);
          return ans;
      }
  }
  ```

  

- [2538. æœ€å¤§ä»·å€¼å’Œä¸æœ€å°ä»·å€¼å’Œçš„å·®å€¼](https://leetcode.cn/problems/difference-between-maximum-and-minimum-price-sum/)

  > ç»™ä½ ä¸€ä¸ª `n` ä¸ªèŠ‚ç‚¹çš„æ— å‘æ— æ ¹å›¾ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º `0` åˆ° `n - 1` ã€‚ç»™ä½ ä¸€ä¸ªæ•´æ•° `n` å’Œä¸€ä¸ªé•¿åº¦ä¸º `n - 1` çš„äºŒç»´æ•´æ•°æ•°ç»„ `edges` ï¼Œå…¶ä¸­ `edges[i] = [ai, bi]` è¡¨ç¤ºæ ‘ä¸­èŠ‚ç‚¹ `ai` å’Œ `bi` ä¹‹é—´æœ‰ä¸€æ¡è¾¹ã€‚
  >
  > æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªä»·å€¼ã€‚ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `price` ï¼Œå…¶ä¸­ `price[i]` æ˜¯ç¬¬ `i` ä¸ªèŠ‚ç‚¹çš„ä»·å€¼ã€‚
  >
  > ä¸€æ¡è·¯å¾„çš„ **ä»·å€¼å’Œ** æ˜¯è¿™æ¡è·¯å¾„ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„ä»·å€¼ä¹‹å’Œã€‚
  >
  > ä½ å¯ä»¥é€‰æ‹©æ ‘ä¸­ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹ `root` ã€‚é€‰æ‹© `root` ä¸ºæ ¹çš„ **å¼€é”€** æ˜¯ä»¥ `root` ä¸ºèµ·ç‚¹çš„æ‰€æœ‰è·¯å¾„ä¸­ï¼Œ**ä»·å€¼å’Œ** æœ€å¤§çš„ä¸€æ¡è·¯å¾„ä¸æœ€å°çš„ä¸€æ¡è·¯å¾„çš„å·®å€¼ã€‚
  >
  > è¯·ä½ è¿”å›æ‰€æœ‰èŠ‚ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹çš„é€‰æ‹©ä¸­ï¼Œ**æœ€å¤§** çš„ **å¼€é”€** ä¸ºå¤šå°‘ã€‚

  è½¬æ¢æˆæ ‘ç›´å¾„ã€‚æ€è·¯éš¾æƒ³ã€‚é€’æ¨æ±‚ç›´å¾„

  è®¡ç®— è¿”å›èŠ‚ç‚¹iä¸‹å»åŒ…å«ã€ä¸åŒ…å«å¶å­èŠ‚ç‚¹çš„æœ€å¤§å€¼

  ```
  class Solution {
       int N = 101000,M = 2*N;
       int[] h = new int[N],e = new int[M],ne = new int[M];
       int idx;
       long ans;
       int[] price;
       void add(int a,int b){
          e[idx] = b;
          ne[idx] = h[a];
          h[a] = idx++;
      }
      long[] dfs(int u,int fa){
          long mx_contains = price[u],mx_un = 0;
          for(int i=h[u];i!=-1;i=ne[i]){
              int j = e[i];
              if(j==fa) continue;
              long[] val = dfs(j,u);
              ans = Math.max(ans,val[0]+mx_un);
              ans = Math.max(ans,val[1]+mx_contains);
              mx_contains = Math.max(mx_contains,val[0]+price[u]);
              mx_un = Math.max(mx_un,val[1]+price[u]);
          }
          return new long[]{mx_contains,mx_un};
      }
      
      public long maxOutput(int n, int[][] edges, int[] pp) {
          price = pp;
          Arrays.fill(h,-1);
          for(int i=0;i<n-1;i++){
              int a = edges[i][0];
              int b = edges[i][1];
              add(a,b);
              add(b,a);
          }
          dfs(0,-1);
          return ans;
      }
  }
  ```

  

## æ¢æ ¹dp

ç”¨çˆ¶èŠ‚ç‚¹çš„çŠ¶æ€æ›´æ–°å­èŠ‚ç‚¹

#### [834. æ ‘ä¸­è·ç¦»ä¹‹å’Œ](https://leetcode.cn/problems/sum-of-distances-in-tree/)

> ç»™å®šä¸€ä¸ªæ— å‘ã€è¿é€šçš„æ ‘ã€‚æ ‘ä¸­æœ‰ `n` ä¸ªæ ‡è®°ä¸º `0...n-1` çš„èŠ‚ç‚¹ä»¥åŠ `n-1` æ¡è¾¹ ã€‚
>
> ç»™å®šæ•´æ•° `n` å’Œæ•°ç»„ `edges` ï¼Œ `edges[i] = [ai, bi]`è¡¨ç¤ºæ ‘ä¸­çš„èŠ‚ç‚¹ `ai` å’Œ `bi` ä¹‹é—´æœ‰ä¸€æ¡è¾¹ã€‚
>
> è¿”å›é•¿åº¦ä¸º `n` çš„æ•°ç»„ `answer` ï¼Œå…¶ä¸­ `answer[i]` æ˜¯æ ‘ä¸­ç¬¬ `i` ä¸ªèŠ‚ç‚¹ä¸æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»ä¹‹å’Œã€‚
>
> - `1 <= n <= 3 * 104`
> - `edges.length == n - 1`
> - `edges[i].length == 2`

ans[i]è¡¨ç¤ºæ¯ä¸ªç‚¹iåˆ°å…¶ä»–ç‚¹çš„è·ç¦»ä¹‹å’Œ

æ˜“é”™ç‚¹ï¼šä¸èƒ½åœ¨æ ‘å½¢dpæ—¶è®¡ç®—å‘ä¸‹èŠ‚ç‚¹ä¸ªæ•°ï¼Œå› ä¸ºè®¡ç®—å‘ä¸‹ä¸ªæ•°æ˜¯å­èŠ‚ç‚¹æ›´æ–°çˆ¶èŠ‚ç‚¹çŠ¶æ€ï¼Œä½†æ˜¯æ¢æ ¹dpæ—¶æ˜¯ç”¨çˆ¶èŠ‚ç‚¹æ›´æ–°å­èŠ‚ç‚¹ã€‚

```
class Solution {
    int N = 31000,M = 2*N;
    int[] h = new int[N],e = new int[M],ne = new int[M];
    int idx,n;
    
    void add(int a,int b){
        e[idx] = b;
        ne[idx] = h[a];
        h[a] = idx++;
    }

    int[] ans,cnt = new int[N];
    //è®¡ç®—0è·ç¦»å„ç‚¹è·ç¦»å’Œ
    void dfs0(int u,int fa,int cnt){
        ans[0] += cnt;
        for(int i=h[u];i!=-1;i=ne[i]){
            int j = e[i];
            if(j==fa) continue;
            dfs0(j,u,cnt+1);
        }
    }
    //è¿”å›å‘ä¸‹çš„èŠ‚ç‚¹ä¸ªæ•°
    int dfs_cnt(int u,int fa){
        int res = 1;
        for(int i=h[u];i!=-1;i=ne[i]){
            int j = e[i];
            if(j==fa) continue;
            int val = dfs_cnt(j,u);
            res += val;
        }
        cnt[u] = res;
        // System.out.println(u+" "+cnt[u]);
        return res;
    }

    void dfs(int u,int fa){
        for(int i=h[u];i!=-1;i=ne[i]){
            int j = e[i];
            if(j==fa) continue;
            int val = cnt[j];
            ans[j] = ans[u] -val + (n-val);
            dfs(j,u);
        }
    }
    public int[] sumOfDistancesInTree(int nn, int[][] edges) {
        n = nn;
        ans = new int[n];
        
        Arrays.fill(h,-1);
        for(int i=0;i<edges.length;i++){
            int a = edges[i][0];
            int b = edges[i][1];
            add(a,b);
            add(b,a);
        }
        //è®¡ç®—ans[0]
        dfs0(0,-1,0);
        // 
        //è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹ä¸‹é¢å…ƒç´ ä¸ªæ•°
        dfs_cnt(0,-1);
        dfs(0,-1);
        return ans;
    }
}
```

#### [2581. ç»Ÿè®¡å¯èƒ½çš„æ ‘æ ¹æ•°ç›®](https://leetcode.cn/problems/count-number-of-possible-root-nodes/)

> Alice æœ‰ä¸€æ£µ `n` ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º `0` åˆ° `n - 1` ã€‚æ ‘ç”¨ä¸€ä¸ªé•¿åº¦ä¸º `n - 1` çš„äºŒç»´æ•´æ•°æ•°ç»„ `edges` è¡¨ç¤ºï¼Œå…¶ä¸­ `edges[i] = [ai, bi]` ï¼Œè¡¨ç¤ºæ ‘ä¸­èŠ‚ç‚¹ `ai` å’Œ `bi` ä¹‹é—´æœ‰ä¸€æ¡è¾¹ã€‚
>
> Alice æƒ³è¦ Bob æ‰¾åˆ°è¿™æ£µæ ‘çš„æ ¹ã€‚å¥¹å…è®¸ Bob å¯¹è¿™æ£µæ ‘è¿›è¡Œè‹¥å¹²æ¬¡ **çŒœæµ‹** ã€‚æ¯ä¸€æ¬¡çŒœæµ‹ï¼ŒBob åšå¦‚ä¸‹äº‹æƒ…ï¼š
>
> - é€‰æ‹©ä¸¤ä¸ª **ä¸ç›¸ç­‰** çš„æ•´æ•° `u` å’Œ `v` ï¼Œä¸”æ ‘ä¸­å¿…é¡»å­˜åœ¨è¾¹ `[u, v]` ã€‚
> - Bob çŒœæµ‹æ ‘ä¸­ `u` æ˜¯ `v` çš„ **çˆ¶èŠ‚ç‚¹** ã€‚
>
> Bob çš„çŒœæµ‹ç”¨äºŒç»´æ•´æ•°æ•°ç»„ `guesses` è¡¨ç¤ºï¼Œå…¶ä¸­ `guesses[j] = [uj, vj]` è¡¨ç¤º Bob çŒœ `uj` æ˜¯ `vj` çš„çˆ¶èŠ‚ç‚¹ã€‚
>
> Alice éå¸¸æ‡’ï¼Œå¥¹ä¸æƒ³é€ä¸ªå›ç­” Bob çš„çŒœæµ‹ï¼Œåªå‘Šè¯‰ Bob è¿™äº›çŒœæµ‹é‡Œé¢ **è‡³å°‘** æœ‰ `k` ä¸ªçŒœæµ‹çš„ç»“æœä¸º `true` ã€‚
>
> ç»™ä½ äºŒç»´æ•´æ•°æ•°ç»„ `edges` ï¼ŒBob çš„æ‰€æœ‰çŒœæµ‹å’Œæ•´æ•° `k` ï¼Œè¯·ä½ è¿”å›å¯èƒ½æˆä¸ºæ ‘æ ¹çš„ **èŠ‚ç‚¹æ•°ç›®** ã€‚å¦‚æœæ²¡æœ‰è¿™æ ·çš„æ ‘ï¼Œåˆ™è¿”å› `0`ã€‚
>
> 2228

cnt[i]è¡¨ç¤ºæ¯ä¸ªiä¸ºæ ¹çš„æ ‘ä¸‹çš„æ‰€æœ‰çŒœæµ‹æ­£ç¡®ä¸ªæ•°ï¼Œæœ€å>=kçš„ä¸ªæ•°æ˜¯ans

å“ˆå¸Œè¡¨å­˜int[]æ— æ³•åˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼Œå­˜çš„æ˜¯åœ°å€

```
class Solution {
    int N = 101000,M = 2*N;
    int[] h = new int[N],e = new int[M],ne = new int[M];
    int idx,n,ans;
    
    void add(int a,int b){
        e[idx] = b;
        ne[idx] = h[a];
        h[a] = idx++;
    }

    //cnt[i]è¡¨ç¤ºä»¥iæ ¹çš„æ»¡è¶³çš„guessçš„ä¸ªæ•°
    int[] cnt = new int[N];

    void dfs0(int u,int fa){
        for(int i=h[u];i!=-1;i=ne[i]){
            int j = e[i];
            if(j==fa) continue;
            if(se.contains(hash(u,j)))
                cnt[0] += 1;
            dfs0(j,u);
        }
    }
    //ç”±äºhashsetå­˜int[]æ— æ•ˆï¼Œæ‰€ä»¥ç”¨Longå­˜
    long hash(int a,int b){
        return 1000000L * a + b;
    }
    HashSet<Long> se = new HashSet<>();
    void dfs(int u,int fa){
        for(int i=h[u];i!=-1;i=ne[i]){
            int j = e[i];
            if(j==fa) continue;
            cnt[j] = cnt[u];
            if(se.contains(hash(u,j)))
                cnt[j] -= 1;
            if(se.contains(hash(j,u)))
                cnt[j] += 1;

            dfs(j,u);
        }
    }

    public int rootCount(int[][] edges, int[][] guesses, int k) {
        Arrays.fill(h,-1);

        n = edges.length+1;
        for(int i=0;i<edges.length;i++){
            int a = edges[i][0];
            int b = edges[i][1];
            add(a,b);
            add(b,a);
        }
        //é¢„å¤„ç†æ‰€æœ‰guesses
        for(int i=0;i<guesses.length;i++)
            se.add(hash(guesses[i][0], guesses[i][1]));
        
        //åˆå§‹,è®¡ç®—cnt[0]
        dfs0(0,-1);
        //æ¢æ ¹dp
        dfs(0,-1);
        for(int i=0;i<n;i++) System.out.println(i+" "+cnt[i]);
        for(int i=0;i<n;i++)
            if(cnt[i]>=k) ans += 1;

        return ans;
    }
}
```

#### [2858. å¯ä»¥åˆ°è¾¾æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„æœ€å°‘è¾¹åè½¬æ¬¡æ•°](https://leetcode.cn/problems/minimum-edge-reversals-so-every-node-is-reachable/)

> ç»™ä½ ä¸€ä¸ª `n` ä¸ªç‚¹çš„ **ç®€å•æœ‰å‘å›¾** ï¼ˆæ²¡æœ‰é‡å¤è¾¹çš„æœ‰å‘å›¾ï¼‰ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º `0` åˆ° `n - 1` ã€‚å¦‚æœè¿™äº›è¾¹æ˜¯åŒå‘è¾¹ï¼Œé‚£ä¹ˆè¿™ä¸ªå›¾å½¢æˆä¸€æ£µ **æ ‘** ã€‚
>
> ç»™ä½ ä¸€ä¸ªæ•´æ•° `n` å’Œä¸€ä¸ª **äºŒç»´** æ•´æ•°æ•°ç»„ `edges` ï¼Œå…¶ä¸­ `edges[i] = [ui, vi]` è¡¨ç¤ºä»èŠ‚ç‚¹ `ui` åˆ°èŠ‚ç‚¹ `vi` æœ‰ä¸€æ¡ **æœ‰å‘è¾¹** ã€‚
>
> **è¾¹åè½¬** æŒ‡çš„æ˜¯å°†ä¸€æ¡è¾¹çš„æ–¹å‘åè½¬ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€æ¡ä»èŠ‚ç‚¹ `ui` åˆ°èŠ‚ç‚¹ `vi` çš„è¾¹ä¼šå˜ä¸ºä¸€æ¡ä»èŠ‚ç‚¹ `vi` åˆ°èŠ‚ç‚¹ `ui` çš„è¾¹ã€‚
>
> å¯¹äºèŒƒå›´ `[0, n - 1]` ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ `i` ï¼Œä½ çš„ä»»åŠ¡æ˜¯åˆ†åˆ« **ç‹¬ç«‹** è®¡ç®— **æœ€å°‘** éœ€è¦å¤šå°‘æ¬¡ **è¾¹åè½¬** ï¼Œä»èŠ‚ç‚¹ `i` å‡ºå‘ç»è¿‡ **ä¸€ç³»åˆ—æœ‰å‘è¾¹** ï¼Œå¯ä»¥åˆ°è¾¾æ‰€æœ‰çš„èŠ‚ç‚¹ã€‚
>
> è¯·ä½ è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º `n` çš„æ•´æ•°æ•°ç»„ `answer` ï¼Œå…¶ä¸­ `answer[i]`è¡¨ç¤ºä»èŠ‚ç‚¹ `i` å‡ºå‘ï¼Œå¯ä»¥åˆ°è¾¾æ‰€æœ‰èŠ‚ç‚¹çš„ **æœ€å°‘è¾¹åè½¬** æ¬¡æ•°ã€‚

ans[i]è¡¨ç¤ºèŠ‚ç‚¹iä¸ºæ ¹çš„åè½¬æ¬¡æ•°

æœ¬é¢˜æ˜¯æœ‰å‘å›¾ã€å›¾è¦å­˜åŒå‘è¾¹ï¼ˆæ­£å‘è¾¹ã€åå‘è¾¹ï¼‰

```
class Solution {
    int N = 101000,M = 2*N;
    int[] h = new int[N],e = new int[M],ne = new int[M],w = new int[M];
    int idx,n;
    int[] ans;
    
    void add(int a,int b,int c){
        e[idx] = b;
        ne[idx] = h[a];
        w[idx] = c;
        h[a] = idx++;
    }

    int dfs0(int u,int fa){
        int res = 0;
        for(int i=h[u];i!=-1;i=ne[i]){
            int j = e[i];
            if (j==fa) continue;
            res += dfs0(j,u) + (w[i]==1?0:1);
        }
        return res;
    }

    void dfs(int u,int fa){

        for(int i=h[u];i!=-1;i=ne[i]){
            int j = e[i];
            if(j==fa) continue;
            ans[j] = ans[u] + (w[i]==1?1:-1);
            dfs(j,u);
        }
    }

    public int[] minEdgeReversals(int nn, int[][] edges) {
        n = nn;
        ans = new int[n];
        Arrays.fill(h,-1);
        for(int i=0;i<edges.length;i++){
            int a = edges[i][0];
            int b = edges[i][1];
            add(a,b,1);
            add(b,a,-1);
        }

        ans[0] = dfs0(0,-1);

        dfs(0,-1);
        return ans;

    }
}
```



#### [310. æœ€å°é«˜åº¦æ ‘](https://leetcode.cn/problems/minimum-height-trees/)

> æ ‘æ˜¯ä¸€ä¸ªæ— å‘å›¾ï¼Œå…¶ä¸­ä»»ä½•ä¸¤ä¸ªé¡¶ç‚¹åªé€šè¿‡ä¸€æ¡è·¯å¾„è¿æ¥ã€‚ æ¢å¥è¯è¯´ï¼Œä»»ä½•ä¸€ä¸ªæ²¡æœ‰ç®€å•ç¯è·¯çš„è¿é€šå›¾éƒ½æ˜¯ä¸€æ£µæ ‘ã€‚
>
> ç»™ä½ ä¸€æ£µåŒ…å« `n` ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ ‡è®°ä¸º `0` åˆ° `n - 1` ã€‚ç»™å®šæ•°å­— `n` å’Œä¸€ä¸ªæœ‰ `n - 1` æ¡æ— å‘è¾¹çš„ `edges` åˆ—è¡¨ï¼ˆæ¯ä¸€ä¸ªè¾¹éƒ½æ˜¯ä¸€å¯¹æ ‡ç­¾ï¼‰ï¼Œå…¶ä¸­ `edges[i] = [ai, bi]` è¡¨ç¤ºæ ‘ä¸­èŠ‚ç‚¹ `ai` å’Œ `bi` ä¹‹é—´å­˜åœ¨ä¸€æ¡æ— å‘è¾¹ã€‚
>
> å¯é€‰æ‹©æ ‘ä¸­ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºæ ¹ã€‚å½“é€‰æ‹©èŠ‚ç‚¹ `x` ä½œä¸ºæ ¹èŠ‚ç‚¹æ—¶ï¼Œè®¾ç»“æœæ ‘çš„é«˜åº¦ä¸º `h` ã€‚åœ¨æ‰€æœ‰å¯èƒ½çš„æ ‘ä¸­ï¼Œå…·æœ‰æœ€å°é«˜åº¦çš„æ ‘ï¼ˆå³ï¼Œ`min(h)`ï¼‰è¢«ç§°ä¸º **æœ€å°é«˜åº¦æ ‘** ã€‚
>
> è¯·ä½ æ‰¾åˆ°æ‰€æœ‰çš„ **æœ€å°é«˜åº¦æ ‘** å¹¶æŒ‰ **ä»»æ„é¡ºåº** è¿”å›å®ƒä»¬çš„æ ¹èŠ‚ç‚¹æ ‡ç­¾åˆ—è¡¨ã€‚
>
> æ ‘çš„ **é«˜åº¦** æ˜¯æŒ‡æ ¹èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹ä¹‹é—´æœ€é•¿å‘ä¸‹è·¯å¾„ä¸Šè¾¹çš„æ•°é‡ã€‚

æ²¡åšå‡ºæ¥

- æ€è·¯1ï¼šå‰¥æ´‹è‘±ï¼ˆæ‹“æ™®åºï¼‰

  ä»å¶å­èŠ‚ç‚¹ï¼ˆåº¦æ˜¯1ï¼‰ä¸€å±‚ä¸€å±‚å¾€ä¸­å¿ƒå‰¥çš®ï¼Œæœ€åå‰©ä¸‹çš„ä¸€æ‰¹ï¼Œå°±æ˜¯æœ€å°çš„

  å› ä¸ºæœ€å°é«˜åº¦çš„æ ‘çš„æ ¹ä¸€å®šåœ¨ä¸­é—´

  

- æ–¹æ³•2ï¼šæ¢æ ¹dpï¼Œå®ç°èµ·æ¥éº»çƒ¦ï¼Œæ±‚å‘ä¸‹æœ€é•¿ã€æ¬¡é•¿è·¯å¾„



#### [å–æ ‘](https://www.lanqiao.cn/courses/38752/learning/?id=2546156&compatibility=false)

![image-20240523163528214](images/image-20240523163528214.png)

éš¾åº¦ä¸å°ã€ç»†èŠ‚å¤šã€å¤æ‚

- æ€è·¯

  ä¸€æ£µæ ‘çš„ä»·å€¼æ˜¯æ ¹èŠ‚ç‚¹çš„æœ€å¤§å‘ä¸‹é«˜åº¦mxd

  æ ¹æ˜¯xçš„æ ‘çš„ç›ˆåˆ©ansæ˜¯ mxd[x] * k - äº¤æ¢æ ¹çš„æ¬¡æ•°*c

  èŠ‚ç‚¹xäº¤æ¢æ ¹çš„æ¬¡æ•°å…¶å®å°±æ˜¯åœ¨1æ˜¯æ ¹æ—¶å…¶ä»–èŠ‚ç‚¹xçš„é«˜åº¦

- æ ¸å¿ƒ

  **æ¢æ ¹æ—¶ç»´æŠ¤uå’Œjçš„å‘ä¸‹æœ€å¤§é«˜åº¦**ï¼Œéœ€è¦åœ¨dfs0æ—¶è®¡ç®—æ‰€æœ‰èŠ‚ç‚¹çš„å‘ä¸‹æœ€å¤§é«˜åº¦

- ç»†èŠ‚

  - å…ˆè¿›è¡Œdfs0è®¡ç®—1æ˜¯æ ¹æ—¶æ¯ä¸ªèŠ‚ç‚¹å‘ä¸‹æœ€å¤§æ·±åº¦mxdï¼Œä»¥åŠæ¯ä¸ªèŠ‚ç‚¹çš„é«˜åº¦

  - è¿›è¡Œæ¢æ ¹dpï¼Œå…·ä½“çš„ï¼Œåœ¨å†…éƒ¨ï¼š
    - æ›´æ–°å½“å‰èŠ‚ç‚¹uæ˜¯æ ¹çš„æƒ…å†µä¸‹ï¼Œå…¶ä»–æ‰€æœ‰èŠ‚ç‚¹å‘ä¸‹çš„æœ€å¤§é«˜åº¦ï¼ˆåŒ…æ‹¬faï¼Œå› ä¸ºfaåœ¨æ­¤æ—¶ä¹Ÿæ˜¯uçš„å„¿å­ï¼‰ï¼Œä»è€Œæ›´æ–°ans
    - è®¡ç®—å½“å‰èŠ‚ç‚¹uçš„å‘ä¸‹æœ€å¤§ã€æ¬¡å¤§é«˜åº¦ï¼ˆåŒ…æ‹¬faï¼Œå› ä¸ºfaåœ¨æ­¤æ—¶ä¹Ÿæ˜¯uçš„å„¿å­ï¼‰ï¼Œå› ä¸ºæ¢jæ˜¯æ ¹æ—¶ï¼Œéœ€è¦æ›´æ–°èŠ‚ç‚¹uçš„é«˜åº¦
    - æ¢æ ¹dpï¼Œæšä¸¾æ‰€æœ‰å­èŠ‚ç‚¹ï¼ˆä¸åŒ…æ‹¬uï¼Œå› ä¸ºuå·²ç»åšè¿‡æ ¹äº†ï¼‰ä½œä¸ºæ ¹çš„æƒ…å†µï¼Œæ ¹æ®mx1ã€mx2ä»¥åŠmxd[j]+1çš„å…³ç³»ç¡®å®šæ¢jæ˜¯æ ¹æ—¶ï¼Œmxd[u]çš„å€¼

```
import java.util.*;
import java.io.*;
import java.math.*;

public class Main {
	static int INF = Integer.MAX_VALUE;
	static int mod = 1000000007 ;
	static int N = 101000,M = 2*N;
  static int[] mxd = new int[N],dep = new int[N],cnt = new int[N];
	static int n,k,c;
	static long ans;
	static int[] h = new int[N],e = new int[M],ne = new int[M];
  static int idx;
  static void add(int a,int b){
    e[idx] = b;
    ne[idx] = h[a];
    h[a] = idx++;
  }
  //è®¡ç®—å‘ä¸‹æœ€å¤§é«˜åº¦mxd,ä»¥åŠæ¯ä¸ªç‚¹çš„é«˜åº¦dep
  static void dfs0(int u,int fa){
    for(int i=h[u];i!=-1;i=ne[i]){
      int j = e[i];
      if(j==fa) continue;
      dep[j] = dep[u] + 1;
      dfs0(j,u);
      mxd[u] = Math.max(mxd[u],mxd[j]+1);
    }
  }
  static void dfs(int u,int fa){
    //ä»¥uä½œä¸ºæ ¹æ—¶çš„ç­”æ¡ˆè´¡çŒ®ï¼ˆåŒ…æ‹¬faï¼‰
    int mx = 0;
    for(int i=h[u];i!=-1;i=ne[i]){
      int j = e[i];
      mx = Math.max(mx,mxd[j]+1);
    }
    ans = Math.max(ans,(long) mx * k - (long)dep[u]*c);
    
    //è®¡ç®—èŠ‚ç‚¹uçš„å‘ä¸‹æœ€å¤§é«˜åº¦ã€æ¬¡å¤§ï¼ˆåŒ…æ‹¬faï¼‰ï¼Œå› ä¸ºè¦ç®—jçš„æœ€å¤§é«˜åº¦
    int mx1 = 0,mx2 = 0;
    for(int i=h[u];i!=-1;i=ne[i]){
      int j = e[i];
    //   if(j==fa) continue;//å†™è¿™ä¸ªä¼šWA
      if(mxd[j]+1 > mx1){
        mx2 = mx1;
        mx1 = mxd[j]+1;
      }
      else if(mxd[j]+1 > mx2)
        mx2 = mxd[j]+1;
    }
    
    //æ¢æ ¹dp
    for(int i=h[u];i!=-1;i=ne[i]){
      int j = e[i];
      if(j==fa) continue;
      //æ¢uçš„é«˜åº¦
      if(mxd[j]+1!=mx1) mxd[u] = mx1;
      else mxd[u] = mx2;
      
      dfs(j,u);
    }
  }
	static void solve() {
		dfs0(1,-1);
    //æ¢æ ¹dp
    dfs(1,-1);
    System.out.println(ans);
	}

	public static void main(String[] args) throws IOException {
    int t = sc.nextInt();
    while(t-->0){
      Arrays.fill(h,-1);
      Arrays.fill(mxd,0);
      Arrays.fill(dep,0);

      idx = 0;
      ans = 0;
      n = sc.nextInt();
		  k = sc.nextInt();
      c = sc.nextInt();
		  for(int i=1;i<=n-1;i++) {
			  int a = sc.nextInt();
        int b = sc.nextInt();
        add(a,b);
        add(b,a);
		  }
		  solve();
    }
		out.flush();
	}
	static PrintWriter out = new PrintWriter(System.out);
	// static Read sc = new Read();
	static Scanner sc = new Scanner(System.in);

}
class Read{
	StreamTokenizer st = new StreamTokenizer(new BufferedReader(new InputStreamReader(System.in)));
	BufferedReader r = new BufferedReader(new InputStreamReader(System.in));
	
	int nextInt() throws IOException {
		st.nextToken();
		return (int)st.nval;
	}
	String getLine() throws IOException {
		return r.readLine();
	}
}
```



## çŠ¶å‹DP

- æ—¶é—´å¤æ‚åº¦

  çŠ¶æ€å‹ç¼©dpå°†n!çº§åˆ«çš„é—®é¢˜ä¼˜åŒ–æˆ2^nçš„

- æ ¸å¿ƒæ€æƒ³ï¼šä¸å…³æ³¨æ’åˆ—é—®é¢˜ï¼Œåªå…³å¿ƒè¿™ä¸ªæ•°é€‰æ²¡é€‰ï¼Œæ‰€ä»¥æ˜¯2^n

- ä¼˜åŒ–äº†ä»€ä¹ˆï¼šé‡å¤çš„çŠ¶æ€

  å…¨æ’åˆ—æ—¶ï¼šï¼ˆ0ï¼Œ1ï¼Œ2ï¼‰å’Œï¼ˆ0,2,1ï¼‰çš„é€‰æ‹©å¯¹äºåé¢çš„æ•°çš„é€‰æ‹©å…¶å®æ²¡æœ‰åŒºåˆ«ï¼Œæ‰€ä»¥è¿™å°±æ˜¯é‡å¤çš„çŠ¶æ€ï¼ŒçŠ¶æ€å‹ç¼©dpå°±æ˜¯ä¼˜åŒ–äº†è¿™é‡Œã€‚è¿™æ ·çš„é‡å¤å­é—®é¢˜ï¼Œæ˜¯æœ¬é¢˜å¯ä»¥ç”¨ DP ä¼˜åŒ–çš„å…³é”®ã€‚æ¢å¥è¯è¯´ï¼Œå‰é¢çš„æ’åˆ—å…·ä½“é•¿å•¥æ ·ï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒï¼Œ**æˆ‘ä»¬è®°å½•çš„æ˜¯æ— åºçš„é›†åˆï¼Œä¸æ˜¯æœ‰åºçš„åˆ—è¡¨**ã€‚

### ä½è¿ç®—é›†åˆè®º

https://leetcode.cn/circle/discuss/CaOJ45/

![image-20240518142209234](images/image-20240518142209234.png)



### æ¨¡æ¿

ç›¸é‚»æ— å…³

```
for(int mask=0;mask<(1<<m);mask++){
	for(int j=0;j<m;j++){//jæ˜¯æœ€åä¾æ¬¡é€‰æ‹©äº†å“ªä¸ªæ•°
		int i = getCnt(mask);//iæ˜¯å½“å‰ä½ç½®ä¸‹æ ‡
		if((mask>>j&1)==0) continue;
		dp[mask] = Math.max(dp[mask],dp[mask & ~(1<<j)])
	}
}
```

ç›¸é‚»ç›¸å…³

```
for(int mask = 0;mask < (1<<n);mask ++ ){//çŠ¶æ€
	int i = getCnt(mask);//ä¸‹æ ‡ï¼ˆ1çš„ä¸ªæ•°ï¼‰
    for(int last = 0;last<n;last++){//æœ€åä¸€æ¬¡é€‰æ‹©
		if((mask>>last&1)==0 ) continue;
        for(int j=0;j<n;j++){//å€’æ•°ç¬¬äºŒæ¬¡é€‰æ‹©
           	if((mask>>j&1)==0 || j==last || ...) continue;
           	dp[mask][last] += dp[mask & ~(1<<last)][j];
		}
	}
}
```





### æ’åˆ—å‹â‘  ç›¸é‚»æ— å…³

æš´åŠ›åšæ³•æ˜¯æšä¸¾æ•°ç»„ ğ‘çš„æ‰€æœ‰æ’åˆ—ï¼Œå¯¹æ¯ä¸ªæ’åˆ—è®¡ç®—å’Œé¢˜ç›®æœ‰å…³çš„å€¼ï¼Œæ—¶é—´å¤æ‚åº¦ï¼ˆé€šå¸¸æ¥è¯´ï¼‰æ˜¯`O(n * n!)`ã€‚å¯ä»¥è§£å†³ ğ‘›â‰¤10çš„é—®é¢˜ã€‚çŠ¶å‹ DP å¯ä»¥æŠŠæ—¶é—´å¤æ‚åº¦ï¼ˆé€šå¸¸æ¥è¯´ï¼‰ä¼˜åŒ–è‡³ `ğ‘‚(ğ‘› * 2^ğ‘›)`ã€‚å¯ä»¥è§£å†³ ğ‘›â‰¤20çš„é—®é¢˜ã€‚

ä¸€èˆ¬å®šä¹‰ ğ‘“[ğ‘†]è¡¨ç¤ºå·²ç»æ’åˆ—å¥½çš„å…ƒç´ ï¼ˆä¸‹æ ‡ï¼‰é›†åˆä¸º ğ‘†æ—¶ï¼Œå’Œé¢˜ç›®æœ‰å…³çš„æœ€ä¼˜å€¼ã€‚é€šè¿‡æšä¸¾å½“å‰ä½ç½®è¦å¡«çš„å…ƒç´ æ¥è½¬ç§»ã€‚æ¨¡æ¿å¦‚ä¸‹ï¼š

```
		int[] dp = new int[(1<<20)];
		int n = nums.length;//ç‰©å“çš„ä¸ªæ•°
        int m = 2*numSlots;//ç¯®å­çš„ä¸ªæ•°
        //é—®é¢˜ï¼šå°†nä¸ªæ•°åˆ’åˆ†ç»™mä¸ªç¯®å­é‡Œï¼Œn<=mï¼Œç¯®å­é‡Œå¯èƒ½æ²¡ä¸œè¥¿
        //æ€è·¯ï¼šæ¯ä¸ªæ•°åˆ’åˆ†åˆ°å“ªä¸ªç¯®å­é‡Œ,æ‰€ä»¥å°±æ˜¯m!çº§åˆ«çš„æ—¶é—´å¤æ‚åº¦A(m,n)ï¼Œè¿˜æ˜¯é˜¶ä¹˜çº§åˆ«çš„
        //çŠ¶å‹dpæ€è·¯ï¼šæšä¸¾æ‰€æœ‰çŠ¶æ€ï¼Œä¸å…³å¿ƒæ’åˆ—é¡ºåºï¼Œå…³å¿ƒç¯®å­é€‰æ²¡é€‰ï¼Œæ‰€ä»¥æ˜¯2^mä¸ªçŠ¶æ€
        //å›ºå®šnä¸ªæ•°ä¸åŠ¨ï¼Œå°†mä¸ªç¯®å­åˆ’åˆ†
        //ç¯®å­ä¸‹æ ‡è¿›è¡Œå…¨æ’åˆ—ï¼ˆmï¼‰
        //ä½¿ç”¨dpè½¬ç§»çŠ¶æ€
        //å½“å±‚æ•°è¶…è¿‡næ—¶ç›´æ¥é€€å‡ºï¼Œå› ä¸ºåªæœ‰nä¸ªæ•°
        for(int mask=0;mask<(1<<m);mask++){//æ‰€æœ‰ç¯®å­çŠ¶æ€
            for(int j=0;j<m;j++){//æœ€åä¸€æ¬¡çš„é€‰æ‹©ï¼Œä¸‹æ ‡ä»0å¼€å§‹
                if((mask>>j&1)==0) continue;
                int i = getCnt(mask);//è¿™ä¸ªé€‰æ‹©çš„ä¸‹æ ‡ï¼Œä»1å¼€å§‹
                if(i>n) continue;
                //ä»ä¸é€‰jçš„çŠ¶æ€ï¼šmask & ~(1<<j)è½¬ç§»è¿‡æ¥
                dp[mask] = Math.max(dp[mask],dp[mask & ~(1<<j)] + val );
                
            }
        }
```

**æ³¨æ„ä¸éœ€è¦é¢å¤–çš„çŠ¶æ€è¡¨ç¤ºå½“å‰è¦å¡«ç¬¬å‡ ä¸ªä½ç½®ï¼Œå› ä¸ºé›†åˆ ğ‘†çš„å¤§å°å°±æ˜¯å½“å‰è¦å¡«çš„ä½ç½®ã€‚ä½¿ç”¨getCntå‡½æ•°è®¡ç®—**

```
int getCnt(int x) {
        int ans = 0;
        while (x != 0) {
            x -= (x & -x); // lowbit
            ans++;
        }
        return ans;
    }
```



- åˆçº§ï¼šç­‰å€¼é…å¯¹é—®é¢˜ï¼Œx ä¸ª A, x ä¸ª B,æ±‚æœ€å¤§/æœ€å°xxå’Œï¼Œ å…¶ä¸­ x å°äºç­‰äº23çš„æƒ…å†µå¯ä»¥è€ƒè™‘
  526.ä¼˜ç¾çš„æ’åˆ—
  1879.ä¸¤ä¸ªæ•°ç»„æœ€å°çš„å¼‚æˆ–å€¼ä¹‹å’Œ
  847.è®¿é—®æ‰€æœ‰èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„
- ä¸­çº§ï¼šä¸ç­‰å€¼é…å¯¹é—®é¢˜ï¼Œx ä¸ª A, y ä¸ªB, å…¶ä¸­ x < y, x è¦é€‰å®Œï¼Œæ±‚æœ€å¤§/æœ€å°xxå’Œï¼Œ å…¶ä¸­ y å°äºç­‰äº 23 çš„æƒ…å†µå¯ä»¥è€ƒè™‘
  1066.æ ¡å›­è‡ªè¡Œè½¦åˆ†é… II
  1595.è¿é€šä¸¤ç»„ç‚¹çš„æœ€å°æˆæœ¬
- é«˜çº§ï¼šx ä¸ª Aï¼Œy ä¸ª B, x <= y*k, k æ˜¯æ¯ä¸ª y é‡Œèƒ½åˆ†é… k ä¸ª x å…ƒç´ ï¼Œæ±‚æœ€å¤§/æœ€å°xxå’Œï¼Œk çš„ y æ¬¡æ–¹å°äºæ•´æ•°èŒƒå›´å¯è€ƒè™‘
  2172.æ•°ç»„çš„æœ€å¤§ä¸å’Œ





#### [526. ä¼˜ç¾çš„æ’åˆ—](https://leetcode.cn/problems/beautiful-arrangement/)

> å‡è®¾æœ‰ä» 1 åˆ° n çš„ n ä¸ªæ•´æ•°ã€‚ç”¨è¿™äº›æ•´æ•°æ„é€ ä¸€ä¸ªæ•°ç»„ `perm`ï¼ˆ**ä¸‹æ ‡ä» 1 å¼€å§‹**ï¼‰ï¼Œåªè¦æ»¡è¶³ä¸‹è¿°æ¡ä»¶ **ä¹‹ä¸€** ï¼Œè¯¥æ•°ç»„å°±æ˜¯ä¸€ä¸ª **ä¼˜ç¾çš„æ’åˆ—** ï¼š
>
> - `perm[i]` èƒ½å¤Ÿè¢« `i` æ•´é™¤
> - `i` èƒ½å¤Ÿè¢« `perm[i]` æ•´é™¤
>
> ç»™ä½ ä¸€ä¸ªæ•´æ•° `n` ï¼Œè¿”å›å¯ä»¥æ„é€ çš„ **ä¼˜ç¾æ’åˆ—** çš„ **æ•°é‡** ã€‚
>
> - `1 <= n <= 15`
>
> é¢˜è§£ï¼šhttps://leetcode.cn/problems/beautiful-arrangement/solutions/938214/gong-shui-san-xie-xiang-jie-liang-chong-vgsia/

æ–¹æ³•1ï¼šå›æº¯+å‰ªæ

æ–¹æ³•2ï¼šçŠ¶æ€å‹ç¼©DP

å®šä¹‰ `f[i][state] `ä¸ºè€ƒè™‘å‰ iä¸ªæ•°ï¼Œä¸”å½“å‰é€‰æ‹©æ–¹æ¡ˆä¸º state çš„æ‰€æœ‰æ–¹æ¡ˆæ•°é‡ã€‚

`O(n*2 âˆ— 2*n)`

```
class Solution {
    int[][] dp = new int[20][50100];
    public int countArrangement(int n) {
        int ans = 0;
        dp[0][0] = 1;
        for(int i=1;i<=n;i++){//å‰iè½®,å…±é€‰äº†iä¸ªæ•°ï¼Œæšä¸¾ç¬¬iä¸ªä½ç½®é€‰ä»€ä¹ˆ
            for(int mask=0;mask<(1<<n);mask++){//æšä¸¾é€‰æ‹©çš„é›†åˆ
                for (int j=0;j<n;j++){//å½“å‰ç¬¬iæ¬¡é€‰äº†å“ªä¸€ä½j
                    //é›†åˆä¸­ä¸å­˜åœ¨j
                    if((mask>>j&1)==0) continue;
                    //é›†åˆçš„jä½ï¼Œå®é™…é€‰æ‹©çš„æ•°æ˜¯j+1
                    int num = j+1;
                    //å‰ªæ
                    if(num%i!=0 && i%num!=0) continue;
                    //state & (~(1 << j)) ä»£è¡¨å°† state ä¸­æ‰€é€‰æ•°å€¼çš„ä½ç½®ç½®é›¶
                    dp[i][mask] += dp[i-1][mask & ~(1<<j)];
                }
            }
        }
        
        return dp[n][(1<<n)-1];
    }
}
```

ä¼˜åŒ–ï¼šå»é™¤æšä¸¾ç¬¬iè½®

é€šè¿‡å¯¹æœ´ç´ çš„çŠ¶å‹ DP çš„åˆ†æï¼Œæˆ‘ä»¬å‘ç°ï¼Œåœ¨å†³ç­–ç¬¬ i ä½çš„æ—¶å€™ï¼Œç†è®ºä¸Šæˆ‘ä»¬åº”è¯¥ä½¿ç”¨çš„æ•°å­—æ•°é‡ä¹Ÿåº”è¯¥ä¸º iä¸ªã€‚

ä½†è¿™ä¸€ç‚¹åœ¨æœ´ç´ çŠ¶å‹ DP ä¸­å¹¶æ²¡æœ‰ä½“ç°ï¼Œè¿™å°±å¯¼è‡´äº†æˆ‘ä»¬åœ¨å†³ç­–ç¬¬ iii ä½çš„æ—¶å€™ï¼Œä»ç„¶éœ€è¦å¯¹æ‰€æœ‰çš„ stateè¿›è¡Œè®¡ç®—æ£€æŸ¥ï¼ˆå³ä½¿æ˜¯é‚£äº›äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ 1çš„å‡ºç°æ¬¡æ•°ä¸ä¸º iä¸ªçš„çŠ¶æ€ï¼‰ã€‚

å› æ­¤æˆ‘ä»¬å¯ä»¥æ¢ä¸ªæ€è·¯è¿›è¡Œæšä¸¾ï¼ˆä½¿ç”¨æ–°çš„çŠ¶æ€å®šä¹‰å¹¶ä¼˜åŒ–è½¬ç§»æ–¹ç¨‹ï¼‰ã€‚

å®šä¹‰ f[state]ä¸ºå½“å‰é€‰æ‹©æ•°å€¼æƒ…å†µä¸º state æ—¶çš„æ‰€æœ‰æ–¹æ¡ˆçš„æ•°é‡ã€‚

å®šä¹‰getCntå‡½æ•°ç”¨äºè®°å½•å½“å‰é€‰åˆ™äº†å¤šå°‘ä¸ªæ•°ï¼ˆå½“å‰é›†åˆä¸­1çš„ä¸ªæ•°ï¼‰

```
class Solution {
    int getCnt(int x) {
        int ans = 0;
        while (x != 0) {
            x -= (x & -x); // lowbit
            ans++;
        }
        return ans;
    }
    public int countArrangement(int n) {
        int mask = 1 << n;
        int[] f = new int[mask];
        f[0] = 1;
        // æšä¸¾æ‰€æœ‰çš„çŠ¶æ€
        for (int state = 1; state < mask; state++) {
            // è®¡ç®— state æœ‰å¤šå°‘ä¸ª 1ï¼ˆä¹Ÿå°±æ˜¯å½“å‰æ’åºé•¿åº¦ä¸ºå¤šå°‘ï¼‰
            int cnt = getCnt(state);
            // æšä¸¾æœ€åä¸€ä½æ•°å€¼ä¸ºå¤šå°‘
            for (int i = 0; i < n; i++) {
                // æ•°å€¼åœ¨ state ä¸­å¿…é¡»æ˜¯ 1
                if (((state >> i) & 1) == 0) continue;
                // æ•°å€¼ï¼ˆi + 1ï¼‰å’Œä½ç½®ï¼ˆcntï¼‰ä¹‹é—´æ»¡è¶³ä»»ä¸€æ•´é™¤å…³ç³»
                if ((i + 1) % cnt != 0 && cnt % (i + 1) != 0) continue;
                // state & (~(1 << i)) ä»£è¡¨å°† state ä¸­æ‰€é€‰æ•°å€¼çš„ä½ç½®ç½®é›¶
                f[state] += f[state & (~(1 << i))];
            }
        }
        return f[mask - 1];
    }
}

```

#### [1879. ä¸¤ä¸ªæ•°ç»„æœ€å°çš„å¼‚æˆ–å€¼ä¹‹å’Œ](https://leetcode.cn/problems/minimum-xor-sum-of-two-arrays/)

> ç»™ä½ ä¸¤ä¸ªæ•´æ•°æ•°ç»„ `nums1` å’Œ `nums2` ï¼Œå®ƒä»¬é•¿åº¦éƒ½ä¸º `n` ã€‚
>
> ä¸¤ä¸ªæ•°ç»„çš„ **å¼‚æˆ–å€¼ä¹‹å’Œ** ä¸º `(nums1[0] XOR nums2[0]) + (nums1[1] XOR nums2[1]) + ... + (nums1[n - 1] XOR nums2[n - 1])` ï¼ˆ**ä¸‹æ ‡ä» 0 å¼€å§‹**ï¼‰ã€‚
>
> - æ¯”æ–¹è¯´ï¼Œ`[1,2,3]` å’Œ `[3,2,1]` çš„ **å¼‚æˆ–å€¼ä¹‹å’Œ** ç­‰äº `(1 XOR 3) + (2 XOR 2) + (3 XOR 1) = 2 + 0 + 2 = 4` ã€‚
>
> è¯·ä½ å°† `nums2` ä¸­çš„å…ƒç´ é‡æ–°æ’åˆ—ï¼Œä½¿å¾— **å¼‚æˆ–å€¼ä¹‹å’Œ** **æœ€å°** ã€‚
>
> è¯·ä½ è¿”å›é‡æ–°æ’åˆ—ä¹‹åçš„ **å¼‚æˆ–å€¼ä¹‹å’Œ** ã€‚
>
> - `n == nums1.length`
> - `n == nums2.length`
> - `1 <= n <= 14`

çŠ¶æ€å‹ç¼©DPæ¨¡ç‰ˆ

æ˜“é”™ç‚¹

```
dp[i][mask] = XXX + (nums1[i-1] ^ nums2[j]));

é”™è¯¯çš„å†™æˆäº†ï¼š
dp[i][mask] = XXX + nums1[i-1] ^ nums2[j]);
å¯¼è‡´WAäº†å¥½å‡ æ¬¡
```



```
class Solution {
    int INF = 0x3f3f3f3f;
    int[][] dp = new int[20][20100];
    int n;
    public int minimumXORSum(int[] nums1, int[] nums2) {
        n = nums1.length;
        for(int i=0;i<20;i++) Arrays.fill(dp[i],INF);
        dp[0][0] = 0;
        for(int i=1;i<=n;i++){
            for(int mask=0;mask<(1<<n);mask ++){
                for(int j=0;j<n;j++){
                    if((mask>>j&1)==0) continue;
                    //å¦‚æœmaskä¸­1çš„ä¸ªæ•°ä¸æ˜¯iå°±å‰ªæ
                    // if(getCnt(mask)!=i) continue;
                    dp[i][mask] = Math.min(dp[i][mask],dp[i-1][mask & ~(1<<j)] + (nums1[i-1] ^ nums2[j]));
                }
            }
        }
        return dp[n][(1<<n)-1];
    }

    int getCnt(int s) {
        int ans = 0;
        for (int i = 0; i < n; i++) ans += (s >> i) & 1;
        return ans;
    }

}
```

#### [1947. æœ€å¤§å…¼å®¹æ€§è¯„åˆ†å’Œ](https://leetcode.cn/problems/maximum-compatibility-score-sum/)

æ–¹æ³•1ï¼šå›æº¯ O(nï¼ * n)

æ–¹æ³•2ï¼šçŠ¶æ€å‹ç¼©DP   

Oï¼ˆn^3 * 2^nï¼‰

```
class Solution {
    int n,m;
    int[][] dp = new int[10][80100];
    public int maxCompatibilitySum(int[][] students, int[][] mentors) {
        m = students.length;
        n = students[0].length;
        //å¯¹äººè¿›è¡Œå…¨æ’åˆ—ï¼Œæ‰€ä»¥æ˜¯äººçš„ä¸ªæ•°m
        for(int i=1;i<=m;i++){
            for(int mask=0;mask<(1<<m);mask++){
                for(int j=0;j<m;j++){
                    if((mask>>j&1)==0) continue;
                    dp[i][mask] = Math.max(dp[i][mask],dp[i-1][mask & ~(1<<j)] + getVal(students[j],mentors[i-1]));
                }

            }
        }
        return dp[m][(1<<m)-1];
    }

    int getVal(int[] a,int[] b){
        int res = 0;
        for(int i=0;i<n;i++)
            if(a[i]==b[i])
                res += 1;
        return res;
    }

}
```

ä¼˜åŒ–åï¼š

Oï¼ˆn^2 * 2^nï¼‰

```
class Solution {
    int n,m;
    int[] dp = new int[80100];
    public int maxCompatibilitySum(int[][] students, int[][] mentors) {
        m = students.length;
        n = students[0].length;
        //å¯¼å¸ˆä¸åŠ¨ï¼Œå­¦ç”Ÿå…¨æ’åˆ—
        //å¯¹äººè¿›è¡Œå…¨æ’åˆ—ï¼Œæ‰€ä»¥æ˜¯äººçš„ä¸ªæ•°m
        for(int mask=0;mask<(1<<m);mask++){
            for(int j=0;j<m;j++){//jæ˜¯æœ€åä¾æ¬¡é€‰æ‹©äº†å“ªä¸ªæ•°
                int i = getCnt(mask);//iæ˜¯è¿™ä¸ªä¸‹æ ‡
                if((mask>>j&1)==0) continue;
                dp[mask] = Math.max(dp[mask],dp[mask & ~(1<<j)] + getVal(students[j],mentors[i-1]));
            }

        }
        
        return dp[(1<<m)-1];
    }

    int getVal(int[] a,int[] b){
        int res = 0;
        for(int i=0;i<n;i++)
            if(a[i]==b[i])
                res += 1;
        return res;
    }

    int getCnt(int x) {
        int ans = 0;
        while (x != 0) {
            x -= (x & -x); // lowbit
            ans++;
        }
        return ans;
    }

}
```

#### [1799. N æ¬¡æ“ä½œåçš„æœ€å¤§åˆ†æ•°å’Œ](https://leetcode.cn/problems/maximize-score-after-n-operations/)

> ç»™ä½  `nums` ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¤§å°ä¸º `2 * n` çš„æ­£æ•´æ•°æ•°ç»„ã€‚ä½ å¿…é¡»å¯¹è¿™ä¸ªæ•°ç»„æ‰§è¡Œ `n` æ¬¡æ“ä½œã€‚
>
> åœ¨ç¬¬ `i` æ¬¡æ“ä½œæ—¶ï¼ˆæ“ä½œç¼–å·ä» **1** å¼€å§‹ï¼‰ï¼Œä½ éœ€è¦ï¼š
>
> - é€‰æ‹©ä¸¤ä¸ªå…ƒç´  `x` å’Œ `y` ã€‚
> - è·å¾—åˆ†æ•° `i * gcd(x, y)` ã€‚
> - å°† `x` å’Œ `y` ä» `nums` ä¸­åˆ é™¤ã€‚
>
> è¯·ä½ è¿”å› `n` æ¬¡æ“ä½œåä½ èƒ½è·å¾—çš„åˆ†æ•°å’Œæœ€å¤§ä¸ºå¤šå°‘ã€‚
>
> å‡½æ•° `gcd(x, y)` æ˜¯ `x` å’Œ `y` çš„æœ€å¤§å…¬çº¦æ•°ã€‚
>
> 2073

æšä¸¾æœ€åä¸¤æ¬¡é€‰æ‹©ã€å¶æ•°å›åˆæ›´æ–°

```
class Solution {
    int n;
    int[] dp = new int[(1<<15)];
    int gcd(int a,int b){
        return b==0?a:gcd(b,a%b);
    }
    public int maxScore(int[] nums) {
        n = nums.length;
        for(int mask=0;mask<(1<<n);mask++){
            for(int j=0;j<n;j++){
                for(int k=0;k<n;k++){
                    if(j==k) continue;
                    if((mask>>j&1)==0) continue;
                    if((mask>>k&1)==0) continue;
                    int i = getCnt(mask);
                    if(i%2==1) continue;
                    dp[mask] = Math.max(dp[mask],dp[mask & ~(1<<j) & ~(1<<k)] + i/2 * gcd(nums[j],nums[k]));
                }
                
            }
        }
        return dp[(1<<n)-1];
    }
    int getCnt(int mask){
        int res = 0;
        while(mask>0){
            res += 1;
            mask -= (mask & -mask);
        }
        return res;
    }
}
```



#### [2172. æ•°ç»„çš„æœ€å¤§ä¸å’Œ](https://leetcode.cn/problems/maximum-and-sum-of-array/)

> ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º `n` çš„æ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•° `numSlots` ï¼Œæ»¡è¶³`2 * numSlots >= n` ã€‚æ€»å…±æœ‰ `numSlots` ä¸ªç¯®å­ï¼Œç¼–å·ä¸º `1` åˆ° `numSlots` ã€‚
>
> ä½ éœ€è¦æŠŠæ‰€æœ‰ `n` ä¸ªæ•´æ•°åˆ†åˆ°è¿™äº›ç¯®å­ä¸­ï¼Œä¸”æ¯ä¸ªç¯®å­ **è‡³å¤š** æœ‰ 2 ä¸ªæ•´æ•°ã€‚ä¸€ç§åˆ†é…æ–¹æ¡ˆçš„ **ä¸å’Œ** å®šä¹‰ä¸ºæ¯ä¸ªæ•°ä¸å®ƒæ‰€åœ¨ç¯®å­ç¼–å·çš„ **æŒ‰ä½ä¸è¿ç®—** ç»“æœä¹‹å’Œã€‚
>
> - æ¯”æ–¹è¯´ï¼Œå°†æ•°å­— `[1, 3]` æ”¾å…¥ç¯®å­ ***`1`\*** ä¸­ï¼Œ`[4, 6]` æ”¾å…¥ç¯®å­ ***`2`\*** ä¸­ï¼Œè¿™ä¸ªæ–¹æ¡ˆçš„ä¸å’Œä¸º `(1 AND ***1\***) + (3 AND ***1\***) + (4 AND ***2***) + (6 AND ***2***) = 1 + 1 + 0 + 2 = 4` ã€‚
>
> è¯·ä½ è¿”å›å°† `nums` ä¸­æ‰€æœ‰æ•°æ”¾å…¥ `numSlots` ä¸ªç¯®å­ä¸­çš„æœ€å¤§ä¸å’Œã€‚
>
> - `n == nums.length`
> - `1 <= numSlots <= 9`
> - `1 <= n <= 2 * numSlots`
> - `1 <= nums[i] <= 15`
> - 2392



- æ–¹æ³•1ï¼šçŠ¶å‹DPï¼ˆäºŒè¿›åˆ¶ï¼‰

  æ¯ä¸ªç¯®å­æœ€å¤šæ”¾2ä¸ªï¼Œæˆ‘ä»¬æŠŠå®ƒå˜æˆ2è¿›åˆ¶çš„ï¼Œæ¯ä¸ªç¯®å­æ‹†æˆä¸¤ä¸ªç¯®å­ï¼Œè¿™æ ·æ¯ä¸ªç¯®å­å°±æ˜¯æœ€å¤šæ”¾1ä¸ªäº†ã€‚ç„¶åå°±2è¿›åˆ¶çš„çŠ¶æ€å‹ç¼©ã€‚

  æ³¨æ„ç‚¹ï¼šç¯®å­åˆ’åˆ†åï¼Œéœ€è¦æ ¹æ®æ–°ç¯®å­ç¼–å·è®¡ç®—ç¯®å­ç¼–å·

  ![image-20240520212021890](images/image-20240520212021890.png)

  å›ºå®šnä¸ªæ•°ä¸åŠ¨ã€å°†mä¸ªç¯®å­åˆ’åˆ†ã€ç¯®å­ä¸‹æ ‡è¿›è¡Œå…¨æ’åˆ—ï¼ˆmï¼‰

  ```
  class Solution {
      int[] dp = new int[(1<<20)];
      int ans = 0;
      public int maximumANDSum(int[] nums, int numSlots) {
          int n = nums.length;
          int m = 2*numSlots;
          //å›ºå®šnä¸ªæ•°ä¸åŠ¨
          //å°†mä¸ªç¯®å­åˆ’åˆ†
          //ç¯®å­ä¸‹æ ‡è¿›è¡Œå…¨æ’åˆ—ï¼ˆmï¼‰
          //ä½¿ç”¨dpè½¬ç§»çŠ¶æ€
          //å½“å±‚æ•°è¶…è¿‡næ—¶ç›´æ¥é€€å‡º
          for(int mask=0;mask<(1<<m);mask++){
              for(int j=0;j<m;j++){
                  if((mask>>j&1)==0) continue;
                  int i = getCnt(mask);
                  if(i>n) continue;
                  dp[mask] = Math.max(dp[mask],dp[mask & ~(1<<j)] + ((j/2+1) & nums[i-1]));
                  ans = Math.max(ans,dp[mask]);
              }
          }
          return ans;
      }
      int getCnt(int mask){
          int res = 0;
          while(mask>0){
              res += 1;
              mask -= (mask & -mask);
          }
          return res;
      }
  }
  ```

- æ–¹æ³•2ï¼šä¸‰è¿›åˆ¶çŠ¶æ€å‹ç¼©DP




### æ’åˆ—å‹ â‘¡ ç›¸é‚»ç›¸å…³

æ¯”ç›¸é‚»æ— å…³å¤šä¸€ä¸ªç»´åº¦ï¼Œä¸€èˆ¬å®šä¹‰` ğ‘“[ğ‘†][ğ‘–] `,è¡¨ç¤ºå·²ç»æ’åˆ—å¥½çš„å…ƒç´ ï¼ˆä¸‹æ ‡ï¼‰é›†åˆä¸º ğ‘†ï¼Œä¸”ä¸Šä¸€ä¸ªå¡«çš„å…ƒç´ ï¼ˆä¸‹æ ‡ï¼‰ä¸º ğ‘– æ—¶ï¼Œå’Œé¢˜ç›®æœ‰å…³çš„æœ€ä¼˜å€¼ã€‚é€šè¿‡æšä¸¾å½“å‰ä½ç½®è¦å¡«çš„å…ƒç´ æ¥è½¬ç§»ã€‚ä¸€èˆ¬æ—¶é—´å¤æ‚åº¦ä¸ºO(n^2 * 2^n)ï¼Œå¯¹æ¯”ç›¸é‚»æ— å…³å¤šä¸€ä¸ªn

#### [2741. ç‰¹åˆ«çš„æ’åˆ—](https://leetcode.cn/problems/special-permutations/)

> ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» **0** å¼€å§‹çš„æ•´æ•°æ•°ç»„ `nums` ï¼Œå®ƒåŒ…å« `n` ä¸ª **äº’ä¸ç›¸åŒ** çš„æ­£æ•´æ•°ã€‚å¦‚æœ `nums` çš„ä¸€ä¸ªæ’åˆ—æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œæˆ‘ä»¬ç§°å®ƒæ˜¯ä¸€ä¸ªç‰¹åˆ«çš„æ’åˆ—ï¼š
>
> - å¯¹äº `0 <= i < n - 1` çš„ä¸‹æ ‡ `i` ï¼Œè¦ä¹ˆ `nums[i] % nums[i+1] == 0` ï¼Œè¦ä¹ˆ `nums[i+1] % nums[i] == 0` ã€‚
>
> è¯·ä½ è¿”å›ç‰¹åˆ«æ’åˆ—çš„æ€»æ•°ç›®ï¼Œç”±äºç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œè¯·å°†å®ƒå¯¹ `109 + 7` **å–ä½™** åè¿”å›ã€‚
>
> - `2 <= nums.length <= 14`

```
class Solution {
    long ans = 0;
    int N = 14;
    int mod = 1000000007;
    long[][] dp = new long[1<<N][N];

    public int specialPerm(int[] nums) {
        int n = nums.length;
        for(int i=0;i<n;i++){
            dp[1<<i][i] = 1;
        }
        for(int mask = 0;mask<(1<<n);mask++){
            for(int last = 0;last<n;last++){
                if((mask>>last&1)==0) continue;
                for(int j=0;j<n;j++){
                    if((mask>>j&1)==0 || j==last) continue;
                    if(nums[last]%nums[j]==0 || nums[j]%nums[last]==0){
                        dp[mask][last] += dp[mask & ~(1<<last)][j];
                        dp[mask][last] %= mod;
                    }
                }
                if(mask==(1<<n)-1)
                    ans += dp[mask][last];
                ans %= mod;
            }
        }
        return (int)ans;
    }
}
```



#### [996. æ­£æ–¹å½¢æ•°ç»„çš„æ•°ç›®](https://leetcode.cn/problems/number-of-squareful-arrays/)

> ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ `A`ï¼Œå¦‚æœè¯¥æ•°ç»„æ¯å¯¹ç›¸é‚»å…ƒç´ ä¹‹å’Œæ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼Œåˆ™ç§°è¿™ä¸€æ•°ç»„ä¸º*æ­£æ–¹å½¢*æ•°ç»„ã€‚
>
> è¿”å› A çš„æ­£æ–¹å½¢æ’åˆ—çš„æ•°ç›®ã€‚ä¸¤ä¸ªæ’åˆ— `A1` å’Œ `A2` ä¸åŒçš„å……è¦æ¡ä»¶æ˜¯å­˜åœ¨æŸä¸ªç´¢å¼• `i`ï¼Œä½¿å¾— A1[i] != A2[i]ã€‚
>
> 1. `1 <= A.length <= 12`
> 2. `0 <= A[i] <= 1e9`
>
> 1932

- éš¾ç‚¹1ï¼šdpæ•°ç»„çš„åˆå§‹åŒ–ï¼Œ1ä¸ªæ•°çš„è´¡çŒ®å°±æ˜¯1

- éš¾ç‚¹2ï¼šå»é‡ï¼Œæˆ‘ä»¬ä½¿ç”¨çŠ¶æ€å‹ç¼©dpä¼šå¤šç®—å¾ˆå¤š

  è¿™å»é‡ç¡®å®éå¸¸æ»´ç§€ï¼Œå¯èƒ½æ¯”åŠ¨æ€è§„åˆ’æœ¬èº«è¿˜è¦éš¾æƒ³ï¼Œ**nä¸ªç›¸åŒçš„æ•°ä»£ç çš„å…¨æ’åˆ—æœ‰n!ç§ï¼Œä½†æ˜¯é€»è¾‘ä¸Šåªæœ‰1ç§**

  å‡è®¾æœ‰3ä¸ªç›¸åŒçš„æ•°ï¼Œè¿™3ä¸ªæ•°åœ¨æœ€ç»ˆçš„æ’åˆ—é‡Œæ˜¯å¯ä»¥éšæ„äº¤æ¢ä½ç½®çš„ï¼Œ3è€…çš„å†…éƒ¨æ’åˆ—æ–¹å¼å…±æœ‰3!ç§ï¼ŒåŠ¨æ€è§„åˆ’çš„ç­”æ¡ˆç›¸å½“äºè¢«æ”¾å¤§äº†3!å€ï¼Œä¹Ÿå°±æ˜¯æœ€åï¼Œæ¯ä¸ªæ•°çš„ä¸ªæ•°cntï¼Œanséƒ½è¦é™¤ä»¥cnt!

  æ‰€ä»¥æˆ‘ä»¬éœ€è¦æœ€åæŠŠæ¯ä¸ªæ•°çš„é‡å¤

```
class Solution {
    int[][] dp = new int[(1<<13)][13];
    int ans = 0;
    HashMap<Integer,Integer> mp = new HashMap<>();
    public int numSquarefulPerms(int[] nums) {
        int n = nums.length;

        //åˆå§‹åŒ–,ä¸€ä¸ªæ•°æ—¶æ»¡è¶³
        for(int i=0;i<n;i++){
            dp[(1<<i)][i] = 1;
            mp.put(nums[i],mp.getOrDefault(nums[i],0)+1);//ç»Ÿè®¡nums[i]å‡ºç°æ¬¡æ•°
        }

        for(int mask = 1;mask<(1<<n);mask++){
            // int i = getCnt(mask);
            for(int last = 0;last<n;last++){
                if((mask>>last&1)==0) continue;
                for(int j = 0;j<n;j++){
                    if((mask>>j&1)==0 || j==last) continue;
                    int s = nums[j] + nums[last];
                    int l = (int)Math.sqrt(s);
                    if(l*l==s)
                        dp[mask][last] += dp[mask & ~(1<<last)][j];
                }
                if(mask == (1<<n)-1) ans += dp[mask][last];
            }
        }
        //å»é‡
        /*
            è¿™å»é‡ç¡®å®éå¸¸æ»´ç§€ï¼Œå¯èƒ½æ¯”åŠ¨æ€è§„åˆ’æœ¬èº«è¿˜è¦éš¾æƒ³ï¼Œ

            å‡è®¾æœ‰3ä¸ªç›¸åŒçš„æ•°ï¼Œè¿™3ä¸ªæ•°åœ¨æœ€ç»ˆçš„æ’åˆ—é‡Œæ˜¯å¯ä»¥éšæ„äº¤æ¢ä½ç½®çš„ï¼Œ3è€…çš„å†…éƒ¨æ’åˆ—æ–¹å¼å…±æœ‰3!ç§ï¼Œ
            åŠ¨æ€è§„åˆ’çš„ç­”æ¡ˆç›¸å½“äºè¢«æ”¾å¤§äº†3!å€
        */
        for(int key:mp.keySet() ){
            int cnt = mp.get(key);
            for(int i=1;i<=cnt;i++)
                ans /= i;
        }

        return ans;
    }
}
```

#### [æ˜Ÿçƒ](https://www.lanqiao.cn/courses/38752/learning/?id=2546151&compatibility=false)

![image-20240521164537057](images/image-20240521164537057.png)



```
import java.util.*;
import java.io.*;
import java.math.*;

public class Main {
	static double INF = Double.MAX_VALUE;
	static int N = 20,M = 2*N;
	static int[] x = new int[N],y = new int[N],z = new int[N],w = new int[N];
  static double[][] dp = new double[1<<N][N];
  static double[][] dist = new double[N][N];

	static int n;
	static double ans = INF;
	
	static void solve() {
    for(int i=0;i<(1<<n);i++)
      Arrays.fill(dp[i],INF);
     
    //é¢„å¤„ç†åˆå§‹çŠ¶æ€
    for(int i=0;i<n;i++){
      dp[1<<i][i] = 0;
    }
    
    //é¢„å¤„ç†è·ç¦»
    for(int i=1;i<=n;i++)
      for(int j=1;j<=n;j++){
        double s = (x[i]-x[j])*(x[i]-x[j]) + (y[i]-y[j])*(y[i]-y[j]) + (z[i]-z[j])*(z[i]-z[j]);
        dist[i][j] = Math.sqrt(s);
      }
        
    for(int mask = 0;mask < (1<<n);mask ++ ){
      for(int last = 0;last<n;last ++){
        if((mask>>last&1)==0) continue;
        for(int j=0;j<n;j++){
          if((mask>>j&1)==0 || j==last) continue;
          dp[mask][last] = Math.min(dp[mask][last],dp[mask & ~(1<<last)][j] + dist[last+1][j+1]*w[last+1]);
        // System.out.printf("%d-%d:%.2f\n",mask,last,dp[mask][last]);
           
        }
        if(mask==(1<<n)-1) ans = Math.min(ans,dp[mask][last]);
      }
    }
    System.out.printf("%.2f",ans);
	}

	public static void main(String[] args) throws IOException {
		
		n = sc.nextInt();
		for(int i=1;i<=n;i++) {
			x[i] = sc.nextInt();
      y[i] = sc.nextInt();
      z[i] = sc.nextInt();
      w[i] = sc.nextInt();
		}
		solve();
		out.flush();
	}
	static PrintWriter out = new PrintWriter(System.out);
	static Read sc = new Read();

}
class Read{
	StreamTokenizer st = new StreamTokenizer(new BufferedReader(new InputStreamReader(System.in)));
	BufferedReader r = new BufferedReader(new InputStreamReader(System.in));
	
	int nextInt() throws IOException {
		st.nextToken();
		return (int)st.nval;
	}
	String getLine() throws IOException {
		return r.readLine();
	}
}
```

#### [å°æ˜çš„å® ç‰©è¢‹](https://www.lanqiao.cn/courses/38752/learning/?id=2546149&compatibility=false)

![image-20240521171543497](images/image-20240521171543497.png)

```
import java.util.*;
import java.io.*;
import java.math.*;

public class Main {
	static int INF = Integer.MAX_VALUE;
	static int N = 50,M = 11;
	static int[][] a = new int[N][N];
  	static long[][] dp= new long[N][1<<M];
  	static int[] maski = new int[N];
	static int n,m;
	static long ans;
  //è®¡ç®—ä¸€è¡Œçš„å® ç‰©æ•°
  static int cal(int mask){
    int res = 0;
    while(mask>0){
      res += 1;
      mask -= (mask&-mask);
    }
    // System.out.println(res);
    return res;
  }
  //è®¡ç®—1è¡Œå†…æ˜¯å¦æ»¡è¶³ä¸ç›¸é‚»çš„æ¡ä»¶
  static boolean check_one(int mask){
    return (mask&(mask>>1))==0;
  }
  //è®¡ç®—ç›¸é‚»2è¡Œæ˜¯å¦æ»¡è¶³ä¸ç›¸é‚»çš„æ¡ä»¶
  static boolean check_two(int mask1,int mask2){
    return (mask1&mask2)==0;
  }
	
	static void solve() {
    //è®¡ç®—åˆå§‹å“ªäº›ä½ç½®å¯ä»¥æ”¾å® ç‰©
    for(int i=1;i<=n;i++){
      for(int j=1;j<=m;j++){
        if(a[i][j]==1)
          maski[i] |= (1<<(j-1));//ä¸‹æ ‡ä»0å¼€å§‹
      }
    }
		for(int i=1;i<=n;i++){
      for(int mask = 0;mask<(1<<m);mask++){//å½“å‰mask
        //åŒä¸€è¡Œæœ‰ç›¸é‚»
        if(check_one(mask)==false) continue;
        //ä¸åˆå§‹ä½ç½®å†²çª
        if(check_two(mask,maski[i])==false) continue;
        for(int last = 0;last<(1<<m);last++){//ä¸Šä¸€å±‚çš„mask
          if(check_two(last,mask)==false || check_one(last)==false) continue;
          if(check_two(last,maski[i-1])==false) continue;
          dp[i][mask] = Math.max(dp[i][mask], dp[i-1][last] + cal(mask));
        }
        if(i==n) ans = Math.max(ans,dp[i][mask]);
      }
    }
    System.out.println(ans);
	}

	public static void main(String[] args) throws IOException {
		
		n = sc.nextInt();
		m = sc.nextInt();
		for(int i=1;i<=n;i++) {
      for(int j=1;j<=m;j++){
        // 1è¡¨ç¤ºä¸èƒ½è£…å® ç‰©äº†ï¼Œ0è¡¨ç¤ºå¯ä»¥è£…
        a[i][j] = sc.nextInt();
      }
		}
		solve();
		out.flush();
	}
	static PrintWriter out = new PrintWriter(System.out);
	static Read sc = new Read();

}
class Read{
	StreamTokenizer st = new StreamTokenizer(new BufferedReader(new InputStreamReader(System.in)));
	BufferedReader r = new BufferedReader(new InputStreamReader(System.in));
	
	int nextInt() throws IOException {
		st.nextToken();
		return (int)st.nval;
	}
	String getLine() throws IOException {
		return r.readLine();
	}
}
```





#### [1681. æœ€å°ä¸å…¼å®¹æ€§](https://leetcode.cn/problems/minimum-incompatibility/)

> ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•° `k` ã€‚ä½ éœ€è¦å°†è¿™ä¸ªæ•°ç»„åˆ’åˆ†åˆ° `k` ä¸ªç›¸åŒå¤§å°çš„å­é›†ä¸­ï¼Œä½¿å¾—åŒä¸€ä¸ªå­é›†é‡Œé¢æ²¡æœ‰ä¸¤ä¸ªç›¸åŒçš„å…ƒç´ ã€‚
>
> ä¸€ä¸ªå­é›†çš„ **ä¸å…¼å®¹æ€§** æ˜¯è¯¥å­é›†é‡Œé¢æœ€å¤§å€¼å’Œæœ€å°å€¼çš„å·®ã€‚
>
> è¯·ä½ è¿”å›å°†æ•°ç»„åˆ†æˆ `k` ä¸ªå­é›†åï¼Œå„å­é›† **ä¸å…¼å®¹æ€§** çš„ **å’Œ** çš„ **æœ€å°å€¼** ï¼Œå¦‚æœæ— æ³•åˆ†æˆåˆ†æˆ `k` ä¸ªå­é›†ï¼Œè¿”å› `-1` ã€‚
>
> å­é›†çš„å®šä¹‰æ˜¯æ•°ç»„ä¸­ä¸€äº›æ•°å­—çš„é›†åˆï¼Œå¯¹æ•°å­—é¡ºåºæ²¡æœ‰è¦æ±‚ã€‚
>
> 2390

åšä¸äº†

å­é›† +



#### [3149. æ‰¾å‡ºåˆ†æ•°æœ€ä½çš„æ’åˆ—](https://leetcode.cn/problems/find-the-minimum-cost-array-permutation/) 

~2600



### é›†åˆ

#### [ç§¯æœ¨ç”»](https://www.lanqiao.cn/courses/38752/learning/?id=2546152&compatibility=false)

![image-20240522122545274](images/image-20240522122545274.png)

```
import java.util.*;

public class Main {

    static int N = 10100000;
    static int mod = 1000000007;
    static long[][] dp = new long[N][3];
    static int n;
    
    static void solve() {

      dp[0][2] = 1;
    
      for(int i=1;i<=n;i++){
        dp[i][2] += dp[i-1][2];
        dp[i][2] += dp[i-1][0];
        dp[i][2] += dp[i-1][1];
        if(i>=2){
          dp[i][2] += dp[i-2][2];
          dp[i][0] += dp[i-2][2];
          dp[i][1] += dp[i-2][2];
        }
        dp[i][0] += dp[i-1][1];
        dp[i][1] += dp[i-1][0];
        dp[i][0]%= mod;
        dp[i][1]%= mod;
        dp[i][2]%= mod;
      }

      System.out.println(dp[n][2]);
    }

    public static void main(String[] args)   {
    Scanner  sc = new Scanner(System.in);
        
        n = sc.nextInt();
       
        solve();
    }
}
```



![image-20240522122434836](images/image-20240522122434836.png)



#### [å›è·¯è®¡æ•°](https://www.lanqiao.cn/courses/38752/learning/)

![image-20240523202539713](images/image-20240523202539713.png)

å¡«ç©ºè€ƒäº†çŠ¶æ€å‹ç¼©dpï¼Œnæ˜¯21ï¼Œ3sï¼Œè¦ç”¨long

```
import java.util.*;
import java.io.*;
import java.math.*;

public class Main {
	static int INF = Integer.MAX_VALUE;
	static int mod = 1000000007 ;
	// static int N = 3010000,M = 2*N;
	// static long[][] dp = new long[N][22];
	static int n,m;
	static long ans;
  static int gcd(int a,int b){
    return b==0?a:gcd(b,a%b);
  }
	
// 	static void solve() {
// 		n = 21;
//     //èµ·ç‚¹é€‰æ‹©çš„æ˜¯èŠ‚ç‚¹1ï¼Œæ˜¯ä¸€ç§æ–¹æ¡ˆ
//     dp[1][0] = 1;
//     for(int mask = 0;mask < (1<<n);mask ++ ){
//       for(int last = 0;last<n;last++){
//         if((mask>>last&1)==0 ) continue;
//         for(int j=0;j<n;j++){
//           if((mask>>j&1)==0 || j==last || gcd(last+1,j+1)!=1) continue;
// //          System.out.println(mask & ~(1<<last));
//           dp[mask][last] += dp[mask & ~(1<<last)][j];
          
//         }
//         if(mask == (1<<n)-1 && last!=0) ans += dp[mask][last];
//       }
//     }
//     System.out.println(ans);
// 	}

	public static void main(String[] args) throws IOException {
		
    // solve();
    System.out.println("881012367360");
	}

	static Scanner sc = new Scanner(System.in);

}
```









## åŒºé—´dp

Oï¼ˆn^3ï¼‰

- æ™®é€šåŒºé—´dp

  

- ç¯å½¢åŒºé—´dpï¼Œåœ¨é•¿åº¦æ˜¯2*nçš„æ•°ç»„ä¸­åˆå¹¶åŒºé—´

```
for(int len=2;len<=n;len++) {
    for(int i=1;i+len-1<=n+n;i++) {
        int j = i+len-1;
        for(int k=i;k<j;k++) {
        	dp[i][j] = Math.max(dp[i][j], dp[i][k] +dp[k+1][j] + sum[j]-sum[i-1]);

        }
    }
}

//åˆå§‹åŒ–
		for (int i = 1; i < N; i++) {//åˆå§‹åŒ–åˆ°æœ€å¤§ä¸ºN
            Arrays.fill(dp[i],-0x3f3f3f3f);
            dp[i][i] = 0;//ä¸€å †ä¸éœ€è¦åˆå¹¶ï¼Œä»£ä»·æ˜¯0
        }

```

## æ•°ä½dp

- é¢˜ç›®å½¢å¼ï¼šæ‰¾ä¸€ä¸ªåŒºé—´å†…æ»¡è¶³æŸä¸ªæ€§è´¨çš„æ•°çš„ä¸ªæ•°ï¼Œæ•°æ®èŒƒå›´ä¼šå¼€åˆ°10^10ä»¥ä¸Š
- æ•°ä½dpæ€è·¯ï¼šè®¡ç®—0~nä¸­æ»¡è¶³æ¡ä»¶çš„ä¸ªæ•°
- ç­”æ¡ˆï¼šcount(b)-count(a-1)
- éš¾ç‚¹ï¼šå·¦å­æ ‘è®¡ç®—å…¬å¼ï¼ˆå¾ˆå¤šéƒ½ç”¨åˆ°äº†å³è¾¹å¾…æšä¸¾çš„æ•°ä½ä¸ªæ•°iï¼‰

### è®°å¿†åŒ–æœç´¢æ¨¡ç‰ˆ

#### pythonæ¨¡æ¿



ç®€æ´æ¨¡ç‰ˆï¼š(è®¡ç®—1~nçš„æ»¡è¶³æ¡ä»¶çš„)

```python
class Solution:
    def countSpecialNumbers(self, n: int) -> int:
        s = str(n)
        @cache
        def dfs(i:int, mask:int, is_limit:bool, is_num:bool)->int:
            if i == len(s):
                return int(is_num) # 0ä¸æ»¡è¶³æ¡ä»¶
            res = 0
            # å³ä½¿é¢˜ç›®ä¸éœ€è¦è¿™ä¸ªå‚æ•°ä¹Ÿå¯ä»¥ä¿ç•™
            if not is_num:
                res = dfs(i+1,mask,False,False) # å‰i-1ä½éƒ½æ˜¯æ— æ•ˆæ•°å­—
            up = int(s[i]) if is_limit else 9 
            low = 0 if is_num else 1 
            for d in range(low,up+1): 
                if mask>>d&1 == 0: 
                    res += dfs(i+1,mask|(1<<d),is_limit and d==up,True) 
            return res
        return dfs(0,0,True,False) 
```

è®¡ç®—low~highçš„æ»¡è¶³æ¡ä»¶çš„ä¸ªæ•°

```python
class Solution:
    def XXX(self, low: int, high: int, k: int) -> int:
        def cal(s:str):
            @cache
            def dfs(i:int, pre:int, is_limit:bool, is_num:bool)->int:
                if i == len(s):
                    return int(is_num) 
                res = 0
                if not is_num:
                    res = dfs(i+1,pre,False,False) 
                up = int(s[i]) if is_limit else 9
                low = 0 if is_num else 1
                for d in range(low,up+1):
                    if not is_num or abs(pre-d)==1:
                        res += dfs(i+1,d,is_limit and d==up,True) 
                return res
            return dfs(0,0,True,False)
        return cal(str(high)) - cal(str(int(low)-1))
```

- å‚æ•°1ï¼šiè¡¨ç¤ºå½“å‰è¦å¤„ç†ç¬¬iä½

- å‚æ•°2ï¼šmaskè¡¨ç¤ºå‰i-1çš„çŠ¶æ€ã€‚è¿™é‡Œæ˜¯éœ€è¦å˜åŒ–çš„ï¼Œå¯ä»¥æ˜¯pre,ä¹Ÿå¯ä»¥æ˜¯cnt

  - é›†åˆæ˜ å°„æˆä¸€ä¸ªæ•´æ•°

    æ¯”å¦‚ 1,2,5,9ã€‚é‚£ä¹ˆmask == 2^1+2^2+2^5+2^9

  - åˆ¤æ–­æ•°ä½xæ˜¯å¦è¢«é›†åˆé€‰æ‹©è¿‡

    ```
    if mask>>d&1 == 0:
    ```

  - æŠŠæ•°ä½dåŠ å…¥åˆ°é›†åˆä¸­

    ```
    mask = mask|(1<<d)
    ```

    

- å‚æ•°3ï¼šis_limit è¡¨ç¤ºç¬¬iä½çš„å–å€¼ä¸Šç•Œæ˜¯å¦æœ‰ä¸Šé™ï¼Œå¦‚æœTrueï¼Œç¬¬iä½æœ€å¤§æ˜¯int(s[i]);å¦åˆ™å°±æ˜¯9ã€‚

  ç¬¬iä½æ˜¯å¦æœ‰ä¸Šç•Œï¼Œå–å†³äºå‰iä½æ˜¯å¦éƒ½æ˜¯åœ¨å³å­æ ‘ä¸Šï¼Œå¦‚æœæ˜¯ï¼Œå°±æ˜¯æœ‰ä¸Šç•Œ

- å‚æ•°4ï¼šis_num è¡¨ç¤ºå‰i-1ä½æ˜¯å¦å¡«äº†æœ‰æ•ˆæ•°å­—ï¼ˆå†³å®šç¬¬iä½çš„å–å€¼ä¸‹ç•Œï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œä¸‹ç•Œå°±æ˜¯0ï¼›å¦åˆ™ä¸‹ç•Œæ˜¯1.ï¼ˆç”¨æ¥å¤„ç†å‰å¯¼0çš„æƒ…å†µï¼‰

  - ç®€å•çš„è¯´ï¼Œå¦‚æœå‰å¯¼0å¯¹ç­”æ¡ˆæ²¡æœ‰å½±å“ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°is_numå°±ä¸éœ€è¦ï¼Œå¦‚æœå‰å¯¼0å¯¹ç­”æ¡ˆæœ‰å½±å“ï¼Œå°±éœ€è¦è¿™ä¸ªå‚æ•°ã€‚

  - å…·ä½“çš„ï¼Œå¦‚æœé¢˜ç›®è¦æ±‚çš„æ¡ä»¶æ˜¯ï¼šæ¯ä¸ªæ•°ä½éƒ½ä¸ç›¸åŒï¼Œé‚£ä¹ˆ000001æ˜¯æ»¡è¶³ç­”æ¡ˆçš„ï¼Œä½†æ˜¯åœ¨æ•°ä½dpçš„ä»£ç é‡Œé¢å‰å¯¼0ä¼šè¢«å½“ä½œç›¸åŒçš„æ•°ä½ï¼Œä»è€Œå¯¼è‡´1ä¸æ˜¯æ»¡è¶³æ¡ä»¶çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠå‰å¯¼0çš„æ»¡è¶³æ¡ä»¶çš„ä¹ŸåŠ ä¸Šï¼Œæ‰€ä»¥æœ‰ä¸‹é¢çš„ä»£ç 

    ```
        if not is_num:
           res = f(i+1,pre,False,False) 
    ```

  - æ­¤å¤–ï¼Œåœ¨é€’å½’çš„å‡ºå£å¤„ï¼Œéœ€è¦å†™æˆå¦‚ä¸‹çš„å½¢å¼ã€‚å¦‚æœis_numæ˜¯Trueï¼Œä»£è¡¨æ˜¯ä¸€ä¸ªæ•°ï¼Œå°±è®¡æ•°ï¼›å¦‚æœis_numæ˜¯Falseï¼Œä»£è¡¨æ‰€æœ‰æ•°ä½éƒ½æ˜¯å‰å¯¼0ï¼Œè¡¨ç¤ºç©ºé›†ï¼Œä»€ä¹ˆéƒ½æ²¡é€‰ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸æ»¡è¶³æ¡ä»¶çš„

    ```
    	if i == len(s):
           return int(is_num) 
    ```

    

#### Javaæ¨¡æ¿

å…¶ä»–è¯­è¨€éœ€è¦è‡ªå·±è®°å¿†åŒ–ï¼Œç”¨æ•°ç»„æ¨¡æ‹Ÿï¼Œæˆ–è€…ç”¨å“ˆå¸Œè¡¨æ¨¡æ‹Ÿ

åªéœ€è¦è®°å¿†2ä¸ªçŠ¶æ€ï¼šä¸‹æ ‡iå’Œmask(æˆ–è€…pre)å³å¯ï¼Œä¸éœ€è¦è®°å½•å…¶ä»–çš„

ä½†æ˜¯æœ‰ä¸€ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„ï¼šé‚£å°±æ˜¯è·å–memoæ•°ç»„å’Œè®°å½•memoæ•°ç»„æ˜¯æœ‰æ¡ä»¶çš„ï¼š!isLimit && isNum

```

    static long[][] f = new long[N][M];
    static char[] s;
    static long dfs(int u,int cntt,boolean is_num,boolean is_limit){
        if(u==s.length){

        }
        
        if(is_num && !is_limit && f[u][cntt]!=-1) return f[u][cntt];
          
        long res = 0;
        if(!is_num) res += dfs(u+1,,false,false);
        
        int lo = is_num?0:1;
        int hi = is_limit?(s[u]-'0'):9;
        
        for(int d = lo;d <= hi;d++)
          res += dfs(u+1,,true,is_limit && d==hi);
        
        if(is_num && !is_limit) 
          f[u][cntt] = res;
        return res;
    }
	
	static long cal(String ss) {
		s = ss.toCharArray();
        //æ¯ä¸€æ¬¡éƒ½éœ€è¦æ¸…ç©º
        for(int i=0;i<N;i++) 
            Arrays.fill(f[i],-1);
        return dfs(0,0,false,true);
	}

	public static void main(String[] args) throws IOException {

		BigInteger l = new BigInteger(sc.next());
		BigInteger r = new BigInteger(sc.next());
        BigInteger l_1 = l.subtract(new BigInteger("1"));
		
        long ans = cal(r.toString()) - cal(l_1.toString());
        System.out.println(ans);
	}
```



mask

```
int f(int i, int mask, boolean isLimit, boolean isNum) {
        if (i == s.length)
            return isNum ? 1 : 0; 
        if (!isLimit && isNum && memo[i][mask] != -1)
            return memo[i][mask];
        int res = 0;
        if (!isNum)
            res = f(i + 1, mask, false, false);
        int up = isLimit ? s[i] - '0' : 9; 
        int lo = isNum ? 0 : 1;
        for (int d = lo; d <= up; ++d) // æšä¸¾è¦å¡«å…¥çš„æ•°å­— d
            if ((mask >> d & 1) == 0) // d ä¸åœ¨ mask ä¸­
                res += f(i + 1, mask | (1 << d), isLimit && d == up, true);
        if (!isLimit && isNum)
            memo[i][mask] = res;
        return res;
}
return f(0, 0, true, false);
```



> !isLimit && isNumæ˜¯å¹²å˜›çš„ï¼š 
>
> ä¸Šé¢ä¸¤ç§çŠ¶æ€å…¶å®å°±æ„å‘³ç€ï¼Œè¿™ä¸¤ä¸ªçŠ¶æ€å…¶å®æ˜¯ä¸ä¼šåå¤å‡ºç°çš„ï¼Œ0000... æˆ–è€… 7653849 è¿™ç§æ˜¯åªä¼šå‡ºç°ä¸€æ¬¡çš„ã€‚è¦ä¹ˆå…¨éƒ¨è·³è¿‡ï¼Œè¦ä¹ˆå…¨éƒ¨é€‰æœ€å¤§å€¼ã€‚ä¸ä¼šç”±å…¶å®ƒçŠ¶æ€è½¬æ¢å‡ºæ¥ï¼Œæ—¢ç„¶åªä¼šå‡ºç°ä¸€æ¬¡ï¼Œé‚£ä¹ˆå°±æ ¹æœ¬ä¸ç”¨ç¼“å­˜ã€‚
>
> å¦‚æœä½ æ²¡æœ‰åŠ è¿™ä¸ªæ¡ä»¶ï¼Œé‚£ä¹ˆå°±ä¼šWA











- [2376. ç»Ÿè®¡ç‰¹æ®Šæ•´æ•°](https://leetcode.cn/problems/count-special-integers/)

> é¢˜æ„ï¼šå¦‚æœä¸€ä¸ªæ­£æ•´æ•°æ¯ä¸€ä¸ªæ•°ä½éƒ½æ˜¯ **äº’ä¸ç›¸åŒ** çš„ï¼Œæˆ‘ä»¬ç§°å®ƒæ˜¯ **ç‰¹æ®Šæ•´æ•°** ã€‚
>
> ç»™ä½ ä¸€ä¸ª **æ­£** æ•´æ•° `n` ï¼Œè¯·ä½ è¿”å›åŒºé—´ `[1, n]` ä¹‹é—´ç‰¹æ®Šæ•´æ•°çš„æ•°ç›®

```python
class Solution:
    def countSpecialNumbers(self, n: int) -> int:
        s = str(n)
        # iè¡¨ç¤ºå½“å‰è¦å¤„ç†ç¬¬iä½
        # maskè¡¨ç¤ºå‰i-1çš„çŠ¶æ€
        # is_limit è¡¨ç¤ºç¬¬iä½çš„å–å€¼ä¸Šç•Œæ˜¯å¦æœ‰ä¸Šé™ï¼Œå¦‚æœæœ‰ï¼Œç¬¬iä½æœ€å¤§æ˜¯int(s[i]);å¦åˆ™å°±æ˜¯9
        # is_num è¡¨ç¤ºå‰i-1ä½æ˜¯å¦å¡«äº†æœ‰æ•ˆæ•°å­—ï¼ˆå†³å®šç¬¬iä½çš„å–å€¼ä¸‹ç•Œï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œä¸‹ç•Œå°±æ˜¯0ï¼›å¦åˆ™ä¸‹ç•Œæ˜¯1.ï¼ˆç”¨æ¥å¤„ç†å‰å¯¼0ï¼‰
        @cache
        def f(i:int, mask:int, is_limit:bool, is_num:bool)->int:
            if i == len(s):
                return int(is_num) # 0ä¸æ»¡è¶³æ¡ä»¶
            res = 0
            if not is_num:
                res = f(i+1,mask,False,False) # å‰i-1ä½éƒ½æ˜¯æ— æ•ˆæ•°å­—
            up = int(s[i]) if is_limit else 9 # ç¬¬iä½çš„ä¸Šç•Œ
            low = 0 if is_num else 1 # ç¬¬iä½çš„ä¸‹ç•Œ
            for d in range(low,up+1): # æšä¸¾ç¬¬iä½å–å€¼
                if mask>>d&1 == 0: # åˆ¤æ–­dä¹‹å‰æ˜¯å¦ä½¿ç”¨è¿‡
                    res += f(i+1,mask|(1<<d),is_limit and d==up,True) 
                    # ç¬¬iä½é€‰æ‹©dï¼Œis_limitä¸‹ä¸€ä½æ˜¯Trueï¼Œå¿…é¡»å‰i-1è½®æ»¡è¶³ï¼Œå¹¶ä¸”ç¬¬iä¸ªæ•°ä¹Ÿæ»¡è¶³
            return res
        return f(0,0,True,False) # åˆå§‹æ—¶ï¼šé›†åˆæ˜¯ç©ºï¼Œç¬¬0ä½ä¹Ÿæ˜¯æœ‰ä¸Šç•Œçš„ï¼Œç¬¬0ä½ä»¥å‰æ²¡æœ‰æœ‰æ•ˆæ•°å­—
```

è§†é¢‘è®²è§£ï¼šhttps://www.bilibili.com/video/BV1rS4y1s721/?spm_id_from=333.999.0.0&vd_source=9df13446957cfa1b1efd5650c5e3a393

é¢˜è§£ï¼šhttps://leetcode.cn/problems/count-special-integers/solutions/1746956/shu-wei-dp-mo-ban-by-endlesscheng-xtgx/



ä¾‹é¢˜

- [2376. ç»Ÿè®¡ç‰¹æ®Šæ•´æ•°](https://leetcode.cn/problems/count-special-integers/)

  ç»å…¸maskä¾‹å­

- [233. æ•°å­— 1 çš„ä¸ªæ•°](https://leetcode.cn/problems/number-of-digit-one/)

  æœ¬é¢˜ä¸éœ€è¦è€ƒè™‘å‰å¯¼0çš„å½±å“ï¼Œæ‰€ä»¥ç¬¬å››ä¸ªå‚æ•°ä¸éœ€è¦

  ```python
  class Solution:
      def countDigitOne(self, n: int) -> int:
          s = str(n)
          @cache
          def f(i:int, cnt1:int, is_limit:bool)->int:
              if i == len(s):
                  return cnt1
              res = 0
              up = int(s[i]) if is_limit else 9 # ç¬¬iä½çš„ä¸Šç•Œ
              for d in range(0,up+1): # æšä¸¾ç¬¬iä½å–å€¼
                  res += f(i+1,cnt1 + (d==1),is_limit and d==up) 
              return res
          return f(0,0,True)
  ```

- [é¢è¯•é¢˜ 17.06. 2å‡ºç°çš„æ¬¡æ•°](https://leetcode.cn/problems/number-of-2s-in-range-lcci/)

  cntç±»å‹ï¼Œç»Ÿè®¡ä¸ªæ•°

- [600. ä¸å«è¿ç»­1çš„éè´Ÿæ•´æ•°](https://leetcode.cn/problems/non-negative-integers-without-consecutive-ones/)

  preç±»å‹

- [2801. ç»Ÿè®¡èŒƒå›´å†…çš„æ­¥è¿›æ•°å­—æ•°ç›®](https://leetcode.cn/problems/count-stepping-numbers-in-range/)ï¼ˆè¿™é¢˜æœ‰ä¸ä¸€æ ·çš„åœ°æ–¹ï¼‰

  è®¡ç®—[low,high]å†…çš„ä¸ªæ•°ï¼Œpreæ¨¡å‹

  æšä¸¾æ•°ä½æ—¶ï¼Œå¦‚æœå‰é¢æ²¡é€‰è¿‡ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªæ•°å¯ä»¥ä»»æ„é€‰

  ```
  if not is_num or abs(pre-d)==1:
  ```

- [902. æœ€å¤§ä¸º N çš„æ•°å­—ç»„åˆ](https://leetcode.cn/problems/numbers-at-most-n-given-digit-set/)

  ä¸éœ€è¦ä¸Šä¸€å±‚çš„çŠ¶æ€ï¼Œé€‰æ³•å‘Šè¯‰äº†ï¼Œæ¯ä½ç”¨å­—ç¬¦ä¸²

- [2719. ç»Ÿè®¡æ•´æ•°æ•°ç›®](https://leetcode.cn/problems/count-of-integers/)

  preæ¨¡å‹ï¼Œå»åŒºé—´ï¼Œå‰å¯¼0æ— å½±å“

- [1012. è‡³å°‘æœ‰ 1 ä½é‡å¤çš„æ•°å­—](https://leetcode.cn/problems/numbers-with-repeated-digits/)

  åå‘æ€è€ƒï¼Œæ±‚è¡¥é›†ï¼Œæ±‚æ‰€æœ‰ä¸å­˜åœ¨é‡å¤æ•°å­—çš„ä¸ªæ•°

- [1397. æ‰¾åˆ°æ‰€æœ‰å¥½å­—ç¬¦ä¸²](https://leetcode.cn/problems/find-all-good-strings/)ï¼ˆæœ‰éš¾åº¦ï¼Œéœ€è¦ç»“åˆä¸€ä¸ªç»å…¸å­—ç¬¦ä¸²ç®—æ³•ï¼‰

  è¿˜æ²¡åšï¼Œdp

- [788. æ—‹è½¬æ•°å­—](https://leetcode.cn/problems/rotated-digits/)

  è¿˜æ²¡åš

- [8013. èŒƒå›´ä¸­ç¾ä¸½æ•´æ•°çš„æ•°ç›®](https://leetcode.cn/problems/number-of-beautiful-integers-in-the-range/)

  å‡å°‘çŠ¶æ€çš„æŠ€å·§ï¼

- [2999. ç»Ÿè®¡å¼ºå¤§æ•´æ•°çš„æ•°ç›®](https://leetcode.cn/problems/count-the-number-of-powerful-integers/)
  åç¼€é™åˆ¶ã€æ•°ä½ä¸Šä¸‹ç•Œå®¹æ˜“é”™

  åˆ†æƒ…å†µé€‰æ‹©æ•°

  ```
  class Solution:
      def numberOfPowerfulInt(self, start: int, finish: int, limit: int, hou: str) -> int:
          
          def cal(s):
              # è®¡ç®—åç¼€åˆ†éš”ä¸‹æ ‡
              split = len(s) - len(hou)
              # å¦‚æœåç¼€æ¯”sé•¿ï¼Œé‚£ä¹ˆåœ¨1~sä¸­å°±æ²¡è§£
              if split<0:
                  return 0
              @cache
              def dfs(u,is_limit):
                  if u==len(s):
                      return 1
                  hi = int(s[u]) if is_limit else 9
                  lo = 0
                  res = 0
                  # å¦‚æœuä¸åœ¨åç¼€ä½ç½®å°±æ­£å¸¸é€‰
                  if u < split:
                      for d in range(lo,min(hi+1,limit+1)):
                          res += dfs(u+1,is_limit and d==hi)
                  else:# åœ¨åç¼€ä½ç½®ä¸Šï¼Œé€‰æ‹©é‚£ä¸€ä¸ª
                      d = int(hou[u-split])
                      if lo <= d <= min(limit,hi):
                          res += dfs(u+1,is_limit and d==hi)
                  return res
              return dfs(0,True)
          return cal(str(finish)) - cal(str(start-1))
  ```

  

### é€’æ¨æ¨¡ç‰ˆ

- å…³é”®ç‚¹

  - 1.æ‰¾åˆ°ä»»æ„ä¸€ä½ä¸Šæ˜¯å“ªäº›å€¼å¯¹ç­”æ¡ˆæœ‰è´¡çŒ®

  - 2.æ ¹æ®æ­¥éª¤1ä¸­æ‰¾åˆ°çš„å¯¹ç­”æ¡ˆæœ‰è´¡çŒ®çš„æ•°ä½ï¼Œæ ¹æ®è¿™ä¸ªå¯¹å½“å‰ä½è¿›è¡Œåˆ’åˆ†

  - lastå­˜æ”¾çš„æ˜¯ä»€ä¹ˆ

  - å·¦å­æ ‘çš„å…¬å¼èƒ½ä¸èƒ½ç”¨dp

  - 3.æœ€åçš„æœ€å³çš„å³å­æ ‘å¯èƒ½å¤šä¸€ç§ç­”æ¡ˆã€‚

  - iæ˜¯ä»n-1æšä¸¾åˆ°0ï¼Œå½“æšä¸¾åˆ°ç¬¬iä½æ—¶ï¼Œ**åé¢å¾…æšä¸¾çš„æ•°ä½çš„ä¸ªæ•°ä¹Ÿæ˜¯i**ï¼Œè¿™æ˜¯éå¸¸é‡è¦çš„ä¸€ä¸ªç»†èŠ‚

  - æœ‰æ—¶éœ€è¦åŠ ä¸Šif(n==0) return 1;ç‰¹åˆ¤n==0æ˜¯å¦æ»¡è¶³æ¡ä»¶

    å¦‚æœä¸æ»¡è¶³ï¼Œè¿™å¥åŠ ä¸åŠ æ— æ‰€è°“ï¼Œå› ä¸ºä¸åŠ è¿™ä¸ªè¿”å›å€¼ä¹Ÿæ˜¯0

    ä½†æ˜¯å¦‚æœæ»¡è¶³ï¼Œé‚£ä¹ˆä¸€å®šè¦return1ã€‚å¦åˆ™é»˜è®¤è¿”å›0ï¼Œå¦‚æœæ±‚1~5ç›´æ¥æ»¡è¶³çš„ä¸ªæ•°ï¼Œæœ€åçš„ç»“æœå°±ä¼šå¤šç®—ä¸€ä¸ªã€‚é‚£ä¹ˆæ­¤æ—¶count(5)-count(0) = count(5)åŒ…æ‹¬äº†0è¿™ä¸ªæƒ…å†µ


```java
	static int count(int n){
        if(n==0) return 1;//åˆ¤æ–­0æ˜¯å¦æ»¡è¶³æ¡ä»¶
        ArrayList<Integer> nums = new ArrayList<>();
        while(n>0){
            nums.add(n%10);
            n/=10;
        }
        n = nums.size();
        int res = 0;
        int last = 0;//å­˜æ”¾ä¸Šä¸€æ—¶åˆ»çš„çŠ¶æ€ï¼Œå¯ä»¥æ˜¯ä¸Šä¸€ä½çš„å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å‰é¢çš„å’Œ
        for (int i = n-1; i >= 0; i--) {
            int x = nums.get(i);
            //å·¦å­æ ‘è®¡ç®—å…¬å¼
            for (int j = 0; j < x; j++) {
            }
            //å³å­æ ‘ä¸€ç›´é€’å½’

             // å³å­æ ‘çš„ç»ˆç‚¹å¯èƒ½ä¼šå¤šä¸€ç§æ–¹æ¡ˆ
             if(i==0 && ) res++;
        }
    	return res;
	}
```



### Javaå†™æ³•

[233. æ•°å­— 1 çš„ä¸ªæ•°](https://leetcode.cn/problems/number-of-digit-one/)

```
class Solution {
    char[] s;
    HashMap<String,Integer> mp = new HashMap<>();
    int dfs(int u,boolean is_limit,int cntt){
        String key = ('0'+u) +"_"+is_limit+ "_" + Integer.toString(cntt);
        if(mp.containsKey(key)) return mp.get(key);

        if(u==s.length) return cntt;
        int hi = 9;
        if(is_limit) hi = s[u]-'0';
        int res = 0;
        for(int d=0;d<=hi;d++){
            res += dfs(u+1,is_limit && d==hi,cntt + (d==1?1:0));
        }
        mp.put(key,res);
        return res;
    }
    public int countDigitOne(int n) {
        s = Integer.toString(n).toCharArray();
        return dfs(0,true,0);
    }
}
```



[2801. ç»Ÿè®¡èŒƒå›´å†…çš„æ­¥è¿›æ•°å­—æ•°ç›®](https://leetcode.cn/problems/count-stepping-numbers-in-range/)

é«˜ç²¾åº¦ + å·¦å³è¾¹ç•Œ

```
import java.math.*;
class Solution {
    int mod = 1000000007;

    long cal(String ss){
        //å¤šæ¬¡æ‰§è¡Œéœ€è¦æ¸…ç©º
        mp.clear();
        s = ss.toCharArray();
        return dfs(0,true,false,-1);
    }
    char[] s;
    HashMap<String,Long> mp = new HashMap<>();
    long dfs(int u,boolean is_limit,boolean is_num,int pre){
        String key = Integer.toString(u) + "_" + is_limit +"_" + is_num + "_" + Integer.toString(pre);
        if(u==s.length) return is_num?1:0;

        if(mp.containsKey(key)) return mp.get(key);
        long res = 0;
        if(is_num == false){
            res += dfs(u+1,false,false,-1);
            res %= mod;
        } 
        int lo = is_num?0:1;
        int hi = is_limit?(s[u]-'0'):9;
        for(int d=lo;d<=hi;d++){
            if(is_num==false || Math.abs(d-pre)==1){
                res += dfs(u+1,is_limit && d==hi,true,d);
                res %= mod;
            }   
        }
        mp.put(key,res);
        return res;
    }
    public int countSteppingNumbers(String low, String high) {

        long h = cal(high);
        long l = cal(new BigInteger(low).subtract(new BigInteger("1")).toString()); //é«˜ç²¾åº¦å‡æ³•
        long ans = (h-l+mod)%mod;
        return (int)ans;
    }
}
```



# é¢˜

[918. ç¯å½¢å­æ•°ç»„çš„æœ€å¤§å’Œ](https://leetcode.cn/problems/maximum-sum-circular-subarray/)

[1186. åˆ é™¤ä¸€æ¬¡å¾—åˆ°å­æ•°ç»„æœ€å¤§å’Œ](https://leetcode.cn/problems/maximum-subarray-sum-with-one-deletion/)

[1043. åˆ†éš”æ•°ç»„ä»¥å¾—åˆ°æœ€å¤§å’Œ](https://leetcode.cn/problems/partition-array-for-maximum-sum/)

[45. è·³è·ƒæ¸¸æˆ II](https://leetcode.cn/problems/jump-game-ii/)

[å‰‘æŒ‡ Offer 47. ç¤¼ç‰©çš„æœ€å¤§ä»·å€¼](https://leetcode.cn/problems/li-wu-de-zui-da-jie-zhi-lcof/)